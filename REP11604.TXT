OBJECT Report 11604 BAS-Update
{
  OBJECT-PROPERTIES
  {
    Date=09/23/13;
    Time=12:00:00;
    Version List=NAVAPAC7.10;
  }
  PROPERTIES
  {
    Permissions=TableData 17=rm,
                TableData 254=rm,
                TableData 11601=rm,
                TableData 11604=rimd;
    CaptionML=[ENU=BAS-Update;
               ENA=BAS-Update];
    OnInitReport=VAR
                   GLSetup@1450000 : Record 98;
                 BEGIN
                   GLSetup.GET;
                   GLSetup.TESTFIELD("Enable GST (Australia)",TRUE);
                 END;

    OnPreReport=VAR
                  BASSetup@1500000 : Record 11600;
                  BASSetupName@1500001 : Code[20];
                BEGIN
                  "BAS Setup".SETRANGE("Date Filter",BASCalcSheet.A3,BASCalcSheet.A4);
                  IF PeriodSelection = PeriodSelection::"Before and Within Period" THEN
                    Heading := Text1450000
                  ELSE
                    Heading := Text1450004;
                  Heading2 := STRSUBSTNO(Text1450005,BASCalcSheet.A3,BASCalcSheet.A4);
                  BASSetupFilter := "BAS Setup".GETFILTERS;
                  BASSetupName := "BAS Setup".GETFILTER("Setup Name");
                  BASSetup.RESET;
                  BASSetup.SETRANGE("Setup Name",BASSetupName);
                  BASSetup.SETFILTER(Type,'%1',BASSetup.Type::"Row Totaling");
                  BASSetup.SETRANGE(Print,FALSE);
                  IF BASSetup.FINDFIRST THEN
                    ERROR(Text1450018,BASSetup."Row No.");
                END;

  }
  DATASET
  {
    { 8531;    ;DataItem;                    ;
               DataItemTable=Table11600;
               DataItemTableView=WHERE(Print=CONST(Yes));
               OnPreDataItem=VAR
                               GLEntry@1450000 : Record 17;
                               VATEntry@1450001 : Record 254;
                             BEGIN
                               IF GETFILTER("Setup Name") = '' THEN
                                 IF SetupName = '' THEN
                                   ERROR(Text1450003,FIELDCAPTION("Setup Name"))
                                 ELSE
                                   SETRANGE("Setup Name",SetupName);

                               SETRANGE("Setup Name",GETRANGEMIN("Setup Name"));
                               GLSetup.GET;
                               IF UpdateBASCalcSheet THEN BEGIN
                                 BASCalcSheet.TESTFIELD(A1);
                                 BASCalcSheet.TESTFIELD("BAS Version");
                                 IF BASCalcSheet.Exported THEN
                                   ERROR(Text1450007,BASCalcSheet.TABLECAPTION);

                                 BASCalcSheet2.SETRANGE(A1,BASCalcSheet.A1);
                                 BASCalcSheet2.SETRANGE(Exported,TRUE);
                                 IF BASCalcSheet2.FINDFIRST THEN
                                   IF NOT CONFIRM(
                                        Text1450015 + '\' + Text1450016 + '\' + Text1450017,
                                        FALSE,BASCalcSheet2."BAS Version",BASCalcSheet2.A1,BASCalcSheet."BAS Version")
                                   THEN
                                     ERROR('');

                                 IF BASCalcSheet.Consolidated THEN BEGIN
                                   IF NOT CONFIRM(Text1450008 + Text1450009,FALSE,BASCalcSheet.A1) THEN
                                     CurrReport.QUIT;
                                   IF NOT GLSetup."BAS Group Company" THEN
                                     ERROR(Text1450010);
                                   IF GLSetup."BAS Group Company" THEN
                                     BASCalcSheet.TESTFIELD("Group Consolidated",TRUE);
                                   BASCalcEntry.RESET;
                                   BASCalcEntry.SETCURRENTKEY("Consol. BAS Doc. No.","Consol. Version No.");
                                   BASCalcEntry.SETRANGE("Consol. BAS Doc. No.",BASCalcSheet.A1);
                                   BASCalcEntry.SETRANGE("Consol. Version No.",BASCalcSheet."BAS Version");
                                   IF BASCalcEntry.FINDFIRST THEN
                                     REPEAT
                                       BASCalcEntry."Consol. BAS Doc. No." := '';
                                       BASCalcEntry."Consol. Version No." := 0;
                                       BASCalcEntry.MODIFY;
                                     UNTIL NOT BASCalcEntry.FINDFIRST;

                                   IF BASBusUnits.FIND('-') THEN
                                     REPEAT
                                       BASCalcSheet1.CHANGECOMPANY(BASBusUnits."Company Name");
                                       BASCalcSheet1.GET(BASBusUnits."Document No.",BASBusUnits."BAS Version");
                                       BASCalcSheet1.Consolidated := FALSE;
                                       BASCalcSheet1.MODIFY;
                                     UNTIL BASBusUnits.NEXT = 0;
                                   BASCalcSheet.Consolidated := FALSE;
                                   BASCalcSheet."Group Consolidated" := FALSE;
                                 END;

                                 IF BASCalcSheet.Updated THEN
                                   IF NOT CONFIRM(Text1450011 + Text1450012,FALSE) THEN
                                     CurrReport.QUIT;

                                 BASCalcEntry.RESET;
                                 BASCalcEntry.SETRANGE("Company Name",COMPANYNAME);
                                 BASCalcEntry.SETRANGE("BAS Document No.",BASCalcSheet.A1);
                                 BASCalcEntry.SETRANGE("BAS Version",BASCalcSheet."BAS Version");
                                 IF BASCalcEntry.FINDFIRST THEN
                                   BASCalcEntry.DELETEALL;

                                 GLEntry.SETCURRENTKEY("BAS Doc. No.","BAS Version");
                                 GLEntry.SETRANGE("BAS Doc. No.",BASCalcSheet.A1);
                                 IF GLEntry.FINDFIRST THEN BEGIN
                                   GLEntry.MODIFYALL("BAS Doc. No.",'');
                                   GLEntry.MODIFYALL("BAS Version",0);
                                 END;
                                 GLEntry.RESET;

                                 VATEntry.SETCURRENTKEY("BAS Doc. No.","BAS Version");
                                 VATEntry.SETRANGE("BAS Doc. No.",BASCalcSheet.A1);
                                 IF VATEntry.FINDFIRST THEN BEGIN
                                   VATEntry.MODIFYALL("BAS Doc. No.",'');
                                   VATEntry.MODIFYALL("BAS Version",0);
                                 END;
                                 VATEntry.RESET;

                                 BASCalcSheet."1A" := 0;
                                 BASCalcSheet."1C" := 0;
                                 BASCalcSheet."1E" := 0;
                                 BASCalcSheet."4" := 0;
                                 BASCalcSheet."1B" := 0;
                                 BASCalcSheet."1D" := 0;
                                 BASCalcSheet."1F" := 0;
                                 BASCalcSheet."1G" := 0;
                                 BASCalcSheet."5B" := 0;
                                 BASCalcSheet."6B" := 0;
                                 BASCalcSheet.G1 := 0;
                                 BASCalcSheet.G2 := 0;
                                 BASCalcSheet.G3 := 0;
                                 BASCalcSheet.G4 := 0;
                                 BASCalcSheet.G7 := 0;
                                 BASCalcSheet.W1 := 0;
                                 BASCalcSheet.W2 := 0;
                                 BASCalcSheet.T1 := 0;
                                 BASCalcSheet.G10 := 0;
                                 BASCalcSheet.G11 := 0;
                                 BASCalcSheet.G13 := 0;
                                 BASCalcSheet.G14 := 0;
                                 BASCalcSheet.G15 := 0;
                                 BASCalcSheet.G18 := 0;
                                 BASCalcSheet.W3 := 0;
                                 BASCalcSheet.W4 := 0;

                                 Window.OPEN(Text1450013 + Text1450014);
                                 ProgressTotal := COUNT;
                                 ProgressCurrent := 0;
                               END;

                               GLSetup.TESTFIELD("LCY Code");
                               HeaderText := STRSUBSTNO(Text1450002,GLSetup."LCY Code");
                               SelectionTypeNo := Selection;
                               PageGroupNo := 1;
                               NextPageGroupNo := 1;
                               FirstPage := TRUE;
                             END;

               OnAfterGetRecord=BEGIN
                                  CalcLineTotal("BAS Setup",TotalAmount,0);
                                  TotalAmount := ROUND(TotalAmount,1,'<');
                                  IF "Print with" = "Print with"::"Opposite Sign" THEN
                                    TotalAmount := -TotalAmount;

                                  IF UpdateBASCalcSheet THEN BEGIN
                                    ProgressCurrent += 1;
                                    Window.UPDATE(1,"Field Label No.");
                                    Window.UPDATE(2,ROUND(ProgressCurrent / ProgressTotal * 10000,1));
                                    CASE "Field No." OF
                                      BASCalcSheet.FIELDNO("1A"):
                                        BASCalcSheet."1A" := TotalAmount;
                                      BASCalcSheet.FIELDNO("1C"):
                                        BASCalcSheet."1C" := TotalAmount;
                                      BASCalcSheet.FIELDNO("1E"):
                                        BASCalcSheet."1E" := TotalAmount;
                                      BASCalcSheet.FIELDNO("4"):
                                        BASCalcSheet."4" := TotalAmount;
                                      BASCalcSheet.FIELDNO("1B"):
                                        BASCalcSheet."1B" := TotalAmount;
                                      BASCalcSheet.FIELDNO("1D"):
                                        BASCalcSheet."1D" := TotalAmount;
                                      BASCalcSheet.FIELDNO("1F"):
                                        BASCalcSheet."1F" := TotalAmount;
                                      BASCalcSheet.FIELDNO("1G"):
                                        BASCalcSheet."1G" := TotalAmount;
                                      BASCalcSheet.FIELDNO("5B"):
                                        BASCalcSheet."5B" := TotalAmount;
                                      BASCalcSheet.FIELDNO("6B"):
                                        BASCalcSheet."6B" := TotalAmount;
                                      BASCalcSheet.FIELDNO(G1):
                                        BASCalcSheet.G1 := TotalAmount;
                                      BASCalcSheet.FIELDNO(G2):
                                        BASCalcSheet.G2 := TotalAmount;
                                      BASCalcSheet.FIELDNO(G3):
                                        BASCalcSheet.G3 := TotalAmount;
                                      BASCalcSheet.FIELDNO(G4):
                                        BASCalcSheet.G4 := TotalAmount;
                                      BASCalcSheet.FIELDNO(G7):
                                        BASCalcSheet.G7 := TotalAmount;
                                      BASCalcSheet.FIELDNO(W1):
                                        BASCalcSheet.W1 := TotalAmount;
                                      BASCalcSheet.FIELDNO(W2):
                                        BASCalcSheet.W2 := TotalAmount;
                                      BASCalcSheet.FIELDNO(T1):
                                        BASCalcSheet.T1 := TotalAmount;
                                      BASCalcSheet.FIELDNO(G10):
                                        BASCalcSheet.G10 := TotalAmount;
                                      BASCalcSheet.FIELDNO(G11):
                                        BASCalcSheet.G11 := TotalAmount;
                                      BASCalcSheet.FIELDNO(G13):
                                        BASCalcSheet.G13 := TotalAmount;
                                      BASCalcSheet.FIELDNO(G14):
                                        BASCalcSheet.G14 := TotalAmount;
                                      BASCalcSheet.FIELDNO(G15):
                                        BASCalcSheet.G15 := TotalAmount;
                                      BASCalcSheet.FIELDNO(G18):
                                        BASCalcSheet.G18 := TotalAmount;
                                      BASCalcSheet.FIELDNO(W3):
                                        BASCalcSheet.W3 := TotalAmount;
                                      BASCalcSheet.FIELDNO(W4):
                                        BASCalcSheet.W4 := TotalAmount;
                                      BASCalcSheet.FIELDNO("7C"):
                                        BASCalcSheet."7C" := TotalAmount;
                                      BASCalcSheet.FIELDNO("7D"):
                                        BASCalcSheet."7D" := TotalAmount;
                                    END;
                                  END;

                                  PageGroupNo := NextPageGroupNo;
                                  IF "New Page" THEN
                                    NextPageGroupNo := PageGroupNo + 1;

                                  IF CurrReport.PAGENO <> 1 THEN
                                    FirstPage := FALSE;
                                END;

               OnPostDataItem=BEGIN
                                IF UpdateBASCalcSheet THEN BEGIN
                                  BASCalcSheet."BAS GST Division Factor" := GLSetup."BAS GST Division Factor";
                                  BASCalcSheet."BAS Setup Name" := GETFILTER("Setup Name");
                                  BASCalcSheet.Updated := TRUE;
                                  BASCalcSheet.MODIFY;
                                  Window.CLOSE;
                                END;
                              END;

               ReqFilterFields=Setup Name }

    { 2   ;1   ;Column  ;FORMAT_TODAY_0_4_   ;
               SourceExpr=FORMAT(TODAY,0,4) }

    { 3   ;1   ;Column  ;Heading             ;
               SourceExpr=Heading }

    { 5   ;1   ;Column  ;CurrReport_PAGENO   ;
               SourceExpr=CurrReport.PAGENO }

    { 6   ;1   ;Column  ;COMPANYNAME         ;
               SourceExpr=COMPANYNAME }

    { 7   ;1   ;Column  ;USERID              ;
               SourceExpr=USERID }

    { 24  ;1   ;Column  ;Heading2            ;
               SourceExpr=Heading2 }

    { 150001;1 ;Column  ;SelectionTypeNo     ;
               SourceExpr=SelectionTypeNo }

    { 150000;1 ;Column  ;PageGroupNo         ;
               SourceExpr=PageGroupNo }

    { 150002;1 ;Column  ;BASSetupFilter      ;
               SourceExpr=BASSetupFilter }

    { 150003;1 ;Column  ;FirstPage           ;
               SourceExpr=FirstPage }

    { 22  ;1   ;Column  ;HeaderText          ;
               SourceExpr=HeaderText }

    { 15  ;1   ;Column  ;BAS_Setup__TABLECAPTION__________BASSetupFilter;
               SourceExpr=TABLECAPTION + ': ' + BASSetupFilter }

    { 19  ;1   ;Column  ;BAS_Setup__Row_No__ ;
               SourceExpr="Row No." }

    { 20  ;1   ;Column  ;BAS_Setup__Field_Description_;
               SourceExpr="Field Description" }

    { 21  ;1   ;Column  ;TotalAmount         ;
               SourceExpr=TotalAmount;
               AutoFormatType=1 }

    { 8   ;1   ;Column  ;BAS_Setup__Field_Label_No__;
               SourceExpr="Field Label No." }

    { 6225;1   ;Column  ;BAS_Setup_Setup_Name;
               SourceExpr="Setup Name" }

    { 5006;1   ;Column  ;BAS_Setup_Line_No_  ;
               SourceExpr="Line No." }

    { 1   ;1   ;Column  ;BAS_Calculation_Sheet___UpdateCaption;
               SourceExpr=BAS_Calculation_Sheet___UpdateCaptionLbl }

    { 4   ;1   ;Column  ;CurrReport_PAGENOCaption;
               SourceExpr=CurrReport_PAGENOCaptionLbl }

    { 12  ;1   ;Column  ;Amounts_are_in_whole_LCYs_Caption;
               SourceExpr=Amounts_are_in_whole_LCYs_CaptionLbl }

    { 13  ;1   ;Column  ;The_report_includes_all_GST_entries_Caption;
               SourceExpr=The_report_includes_all_GST_entries_CaptionLbl }

    { 14  ;1   ;Column  ;The_report_includes_only_closed_GST_entries_Caption;
               SourceExpr=The_report_includes_only_closed_GST_entries_CaptionLbl }

    { 16  ;1   ;Column  ;BAS_Setup__Row_No__Caption;
               SourceExpr=FIELDCAPTION("Row No.") }

    { 17  ;1   ;Column  ;BAS_Setup__Field_Description_Caption;
               SourceExpr=FIELDCAPTION("Field Description") }

    { 18  ;1   ;Column  ;TotalAmountCaption  ;
               SourceExpr=TotalAmountCaptionLbl }

    { 9   ;1   ;Column  ;BAS_Setup__Field_Label_No__Caption;
               SourceExpr=FIELDCAPTION("Field Label No.") }

  }
  REQUESTPAGE
  {
    PROPERTIES
    {
      OnInit=BEGIN
               ExcludeClosingEntriesEnable := TRUE;
             END;

      OnOpenPage=BEGIN
                   UpdateRequestForm;
                 END;

    }
    CONTROLS
    {
      { 1900000001;0;Container;
                  ContainerType=ContentArea }

      { 1900000002;1;Group  ;
                  CaptionML=[ENU=Options;
                             ENA=Options] }

      { 25  ;2   ;Field     ;
                  CaptionML=[ENU=Document No.;
                             ENA=Document No.];
                  SourceExpr=BASCalcSheet.A1;
                  CaptionClass=FORMAT(BASCalcSheet.FIELDNAME(A1));
                  Editable=FALSE }

      { 27  ;2   ;Field     ;
                  CaptionML=[ENU=BAS Version;
                             ENA=BAS Version];
                  SourceExpr=BASCalcSheet."BAS Version";
                  Editable=FALSE }

      { 28  ;2   ;Field     ;
                  CaptionML=[ENU=Period Covered From;
                             ENA=Period Covered From];
                  SourceExpr=BASCalcSheet.A3;
                  CaptionClass=FORMAT(BASCalcSheet.FIELDNAME(A3));
                  Editable=FALSE }

      { 31  ;2   ;Field     ;
                  CaptionML=[ENU=Period Covered To;
                             ENA=Period Covered To];
                  SourceExpr=BASCalcSheet.A4;
                  CaptionClass=FORMAT(BASCalcSheet.FIELDNAME(A4));
                  Editable=FALSE }

      { 14  ;2   ;Field     ;
                  Name=UpdateBASCalcSheet;
                  CaptionML=[ENU=Update BAS Calc. Sheet;
                             ENA=Update BAS Calc. Sheet];
                  SourceExpr=UpdateBASCalcSheet }

      { 1   ;2   ;Field     ;
                  Name=IncludeGSTEntries;
                  CaptionML=[ENU=Include GST Entries;
                             ENA=Include GST Entries];
                  OptionCaptionML=[ENU=Open,Closed,Open and Closed;
                                   ENA=Open,Closed,Open and Closed];
                  SourceExpr=Selection }

      { 4   ;2   ;Field     ;
                  Name=PeriodSelection;
                  CaptionML=[ENU=Include GST Entries;
                             ENA=Include GST Entries];
                  OptionCaptionML=[ENU=Before and Within Period,Within Period;
                                   ENA=Before and Within Period,Within Period];
                  SourceExpr=PeriodSelection }

      { 1450000;2;Field     ;
                  Name=ExcludeClosingEntries;
                  CaptionML=[ENU=Exclude Closing Entries;
                             ENA=Exclude Closing Entries];
                  SourceExpr=ExcludeClosingEntries;
                  Enabled=ExcludeClosingEntriesEnable }

    }
  }
  LABELS
  {
  }
  CODE
  {
    VAR
      Text1450000@1450000 : TextConst 'ENU=GST entries before and within the period;ENA=GST entries before and within the period';
      Text1450002@1450001 : TextConst 'ENU=All amounts are in %1;ENA=All amounts are in %1';
      Text1450003@1450002 : TextConst 'ENU=Please specify filter for %1.;ENA=Please specify filter for %1.';
      Text1450004@1450003 : TextConst 'ENU=GST entries within the period;ENA=GST entries within the period';
      Text1450005@1450004 : TextConst 'ENU=Period: %1..%2;ENA=Period: %1..%2';
      BASCalcSheet@1450005 : Record 11601;
      BASCalcSheet1@1450006 : Record 11601;
      BASCalcSheet2@1450007 : Record 11601;
      BASCalcEntry@1450008 : Record 11604;
      BASBusUnits@1450009 : Record 11603;
      GLSetup@1450011 : Record 98;
      Selection@1450012 : 'Open,Closed,Open and Closed';
      RowNo@1450013 : ARRAY [6] OF Code[10];
      SetupName@1450014 : Code[20];
      BASSetupFilter@1450015 : Text[250];
      Heading@1450016 : Text[50];
      ErrorText@1450017 : Text[80];
      HeaderText@1450018 : Text[50];
      Heading2@1450019 : Text[50];
      FieldLabelNo@1450020 : ARRAY [6] OF Text[30];
      Amount@1450021 : Decimal;
      TotalAmount@1450022 : Decimal;
      ProgressCurrent@1450023 : Integer;
      ProgressTotal@1450024 : Integer;
      i@1450025 : Integer;
      UpdateBASCalcSheet@1450026 : Boolean;
      ExcludeClosingEntries@1450027 : Boolean;
      PeriodSelection@1450028 : 'Before and Within Period,Within Period';
      Text1450007@1450029 : TextConst 'ENU=This %1 has been exported. It cannot be updated.;ENA=This %1 has been exported. It cannot be updated.';
      Text1450008@1450030 : TextConst 'ENU=%1 has been consolidated. You will have to run the consolidate function again.\;ENA=%1 has been consolidated. You will have to run the consolidate function again.\';
      Text1450009@1450031 : TextConst 'ENU=Do you want to continue?;ENA=Do you want to continue?';
      Text1450010@1450032 : TextConst 'ENU=You cannot run this function because this BAS has been consolidated from the group company.;ENA=You cannot run this function because this BAS has been consolidated from the group company.';
      Text1450011@1450033 : TextConst 'ENU=The update has already been completed.\;ENA=The update has already been completed.\';
      Text1450012@1450034 : TextConst 'ENU=Do you want to overwrite current BAS version?;ENA=Do you want to overwrite current BAS version?';
      Text1450013@1450035 : TextConst 'ENU=Current Field     #1##########\;ENA=Current Field     #1##########\';
      Text1450014@1450036 : TextConst 'ENU=Progress          @2@@@@@@@@@@@@@@@@@@@@;ENA=Progress          @2@@@@@@@@@@@@@@@@@@@@';
      Window@1450037 : Dialog;
      Text1450015@1450038 : TextConst 'ENU=Version %1 of BAS Document %2 has already been exported.;ENA=Version %1 of BAS Document %2 has already been exported.';
      Text1450016@1450039 : TextConst 'ENU=If you continue with the update of version %3, you must re export BAS Document %2 to close the entries for this period.;ENA=If you continue with the update of version %3, you must re export BAS Document %2 to close the entries for this period.';
      Text1450017@1450040 : TextConst 'ENU=Do you want to continue ?;ENA=Do you want to continue ?';
      BASCalcEntry1@1500000 : Record 11604;
      Text1450018@1500001 : TextConst 'ENU=You have not selected the print option for Row No %1, this is mandatory for updating values on BAS calculation sheet.;ENA=You have not selected the print option for Row No %1, this is mandatory for updating values on BAS calculation sheet.';
      SelectionTypeNo@150000 : Integer;
      PageGroupNo@150001 : Integer;
      NextPageGroupNo@150002 : Integer;
      FirstPage@150003 : Boolean;
      ExcludeClosingEntriesEnable@19051650 : Boolean INDATASET;
      BAS_Calculation_Sheet___UpdateCaptionLbl@7081 : TextConst 'ENU=BAS Calculation Sheet - Update;ENA=BAS Calculation Sheet - Update';
      CurrReport_PAGENOCaptionLbl@8565 : TextConst 'ENU=Page;ENA=Page';
      Amounts_are_in_whole_LCYs_CaptionLbl@7170 : TextConst 'ENU=Amounts are in whole LCYs.;ENA=Amounts are in whole LCYs.';
      The_report_includes_all_GST_entries_CaptionLbl@5649 : TextConst 'ENU=The report includes all GST entries.;ENA=The report includes all GST entries.';
      The_report_includes_only_closed_GST_entries_CaptionLbl@9165 : TextConst 'ENU=The report includes only closed GST entries.;ENA=The report includes only closed GST entries.';
      TotalAmountCaptionLbl@6778 : TextConst 'ENU=Amount;ENA=Amount';

    PROCEDURE CalcLineTotal@1450000(BASSetup2@1450000 : Record 11600;VAR TotalAmount@1450001 : Decimal;Level@1450002 : Integer) : Boolean;
    VAR
      GLEntry@1450003 : Record 17;
      VATEntry@1450004 : Record 254;
    BEGIN
      BASSetup2.CALCFIELDS("Field Label No.");
      IF Level = 0 THEN BEGIN
        TotalAmount := 0;
        CLEAR(RowNo);
        CLEAR(FieldLabelNo);
      END;
      CASE BASSetup2.Type OF
        BASSetup2.Type::"Account Totaling":
          BEGIN
            GLEntry.RESET;
            GLEntry.SETCURRENTKEY(
              "G/L Account No.",
              "BAS Adjustment",
              "VAT Bus. Posting Group",
              "VAT Prod. Posting Group",
              "Posting Date",
              "BAS Doc. No.");
            GLEntry.SETFILTER("G/L Account No.",BASSetup2."Account Totaling");
            GLEntry.SETRANGE("BAS Adjustment",BASSetup2."BAS Adjustment");
            GLEntry.SETRANGE("VAT Bus. Posting Group",BASSetup2."GST Bus. Posting Group");
            GLEntry.SETRANGE("VAT Prod. Posting Group",BASSetup2."GST Prod. Posting Group");
            GLEntry.SETFILTER(
              "Posting Date",
              GetPeriodFilter(PeriodSelection,BASCalcSheet.A3,BASCalcSheet.A4));
            IF BASCalcSheet.Exported THEN
              GLEntry.SETRANGE("BAS Doc. No.",BASCalcSheet.A1)
            ELSE
              GLEntry.SETRANGE("BAS Doc. No.",'');
            Amount := 0;
            IF BASSetup2."Account Totaling" <> '' THEN BEGIN
              IF GLEntry.FIND('-') THEN
                REPEAT
                  IF
                     (ExcludeClosingEntries AND
                      (GLEntry."Posting Date" = NORMALDATE(GLEntry."Posting Date"))) OR
                     (NOT ExcludeClosingEntries)
                  THEN BEGIN
                    CASE BASSetup2."Amount Type" OF
                      BASSetup2."Amount Type"::Amount:
                        Amount := Amount + GLEntry.Amount;
                      BASSetup2."Amount Type"::"GST Amount":
                        Amount := Amount + GLEntry."VAT Amount";
                    END;
                    IF UpdateBASCalcSheet THEN BEGIN
                      BASCalcEntry.INIT;
                      BASCalcEntry."Company Name" := COMPANYNAME;
                      BASCalcEntry."BAS Document No." := BASCalcSheet.A1;
                      BASCalcEntry."BAS Version" := BASCalcSheet."BAS Version";
                      IF Level = 0 THEN
                        BASCalcEntry."Field Label No." := BASSetup2."Field Label No."
                      ELSE
                        BASCalcEntry."Field Label No." := FieldLabelNo[Level];
                      BASCalcEntry.Type := BASCalcEntry.Type::"G/L Entry";
                      BASCalcEntry."Entry No." := GLEntry."Entry No.";
                      BASCalcEntry."Amount Type" := BASSetup2."Amount Type";
                      CASE BASSetup2."Amount Type" OF
                        BASSetup2."Amount Type"::Amount:
                          BASCalcEntry.Amount := GLEntry.Amount;
                        BASSetup2."Amount Type"::"GST Amount":
                          BASCalcEntry.Amount := GLEntry."VAT Amount";
                      END;
                      BASCalcEntry."Gen. Posting Type" := BASSetup2."Gen. Posting Type";
                      BASCalcEntry."GST Bus. Posting Group" := BASSetup2."GST Bus. Posting Group";
                      BASCalcEntry."GST Prod. Posting Group" := BASSetup2."GST Prod. Posting Group";
                      BASCalcEntry."BAS Adjustment" := BASSetup2."BAS Adjustment";
                      IF NOT BASCalcEntry.INSERT THEN
                        BASCalcEntry.MODIFY;
                    END;
                  END;
                UNTIL GLEntry.NEXT = 0;
            END;
            CalcTotalAmount(BASSetup2,TotalAmount);
          END;
        BASSetup2.Type::"GST Entry Totaling":
          BEGIN
            VATEntry.RESET;
            VATEntry.SETCURRENTKEY(
              Type,
              Closed,
              "BAS Adjustment",
              "VAT Bus. Posting Group",
              "VAT Prod. Posting Group",
              "Posting Date",
              "BAS Doc. No.");
            VATEntry.SETRANGE(Type,BASSetup2."Gen. Posting Type");
            CASE Selection OF
              Selection::Open:
                VATEntry.SETRANGE(Closed,FALSE);
              Selection::Closed:
                VATEntry.SETRANGE(Closed,TRUE);
            END;
            VATEntry.SETRANGE("BAS Adjustment",BASSetup2."BAS Adjustment");
            VATEntry.SETRANGE("VAT Bus. Posting Group",BASSetup2."GST Bus. Posting Group");
            VATEntry.SETRANGE("VAT Prod. Posting Group",BASSetup2."GST Prod. Posting Group");
            VATEntry.SETFILTER(
              "Posting Date",
              GetPeriodFilter(PeriodSelection,BASCalcSheet.A3,BASCalcSheet.A4));
            IF BASCalcSheet.Exported THEN
              VATEntry.SETRANGE("BAS Doc. No.",BASCalcSheet.A1)
            ELSE
              VATEntry.SETRANGE("BAS Doc. No.",'');
            CASE BASSetup2."Amount Type" OF
              BASSetup2."Amount Type"::Amount:
                BEGIN
                  VATEntry.CALCSUMS(Amount);
                  Amount := VATEntry.Amount;
                END;
              BASSetup2."Amount Type"::Base:
                BEGIN
                  VATEntry.CALCSUMS(Base);
                  Amount := VATEntry.Base;
                END;
              BASSetup2."Amount Type"::"Unrealized Amount":
                BEGIN
                  VATEntry.CALCSUMS("Unrealized Amount");
                  Amount := VATEntry."Unrealized Amount";
                END;
              BASSetup2."Amount Type"::"Unrealized Base":
                BEGIN
                  VATEntry.CALCSUMS("Unrealized Base");
                  Amount := VATEntry."Unrealized Base";
                END;
            END;
            IF UpdateBASCalcSheet AND VATEntry.FIND('-') THEN
              REPEAT
                BASCalcEntry.INIT;
                BASCalcEntry."Company Name" := COMPANYNAME;
                BASCalcEntry."BAS Document No." := BASCalcSheet.A1;
                BASCalcEntry."BAS Version" := BASCalcSheet."BAS Version";
                IF Level = 0 THEN
                  BASCalcEntry."Field Label No." := BASSetup2."Field Label No."
                ELSE
                  BASCalcEntry."Field Label No." := FieldLabelNo[Level];
                BASCalcEntry.Type := BASCalcEntry.Type::"GST Entry";
                BASCalcEntry."Entry No." := VATEntry."Entry No.";
                BASCalcEntry."Amount Type" := BASSetup2."Amount Type";
                CASE BASSetup2."Amount Type" OF
                  BASSetup2."Amount Type"::Amount:
                    BASCalcEntry.Amount := VATEntry.Amount;
                  BASSetup2."Amount Type"::Base:
                    BASCalcEntry.Amount := VATEntry.Base;
                  BASSetup2."Amount Type"::"Unrealized Amount":
                    BASCalcEntry.Amount := VATEntry."Unrealized Amount";
                  BASSetup2."Amount Type"::"Unrealized Base":
                    BASCalcEntry.Amount := VATEntry."Unrealized Base";
                END;
                BASCalcEntry."Gen. Posting Type" := BASSetup2."Gen. Posting Type";
                BASCalcEntry."GST Bus. Posting Group" := BASSetup2."GST Bus. Posting Group";
                BASCalcEntry."GST Prod. Posting Group" := BASSetup2."GST Prod. Posting Group";
                BASCalcEntry."BAS Adjustment" := BASSetup2."BAS Adjustment";
                IF NOT BASCalcEntry.INSERT THEN
                  BASCalcEntry.MODIFY;
              UNTIL VATEntry.NEXT = 0;

            CalcTotalAmount(BASSetup2,TotalAmount);
          END;
        BASSetup2.Type::"Row Totaling":
          BEGIN
            IF Level >= ARRAYLEN(RowNo) THEN
              EXIT(FALSE);
            Level := Level + 1;
            RowNo[Level] := BASSetup2."Row No.";
            FieldLabelNo[Level] := BASSetup2."Field Label No.";

            IF BASSetup2."Row Totaling" = '' THEN
              EXIT(TRUE);
            BASSetup2.SETRANGE("Setup Name",BASSetup2."Setup Name");
            BASSetup2.SETFILTER("Row No.",BASSetup2."Row Totaling");
            IF BASSetup2.FIND('-') THEN
              REPEAT
                IF NOT CalcLineTotal(BASSetup2,TotalAmount,Level) THEN BEGIN
                  IF Level > 1 THEN
                    EXIT(FALSE);
                  FOR i := 1 TO ARRAYLEN(RowNo) DO
                    ErrorText := ErrorText + RowNo[i] + ' => ';
                  ErrorText := ErrorText + '...';
                  BASSetup2.FIELDERROR("Row No.",ErrorText);
                END;
              UNTIL BASSetup2.NEXT = 0;
          END;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE CalcTotalAmount@1450001(BASSetup2@1450000 : Record 11600;VAR TotalAmount@1450001 : Decimal);
    BEGIN
      IF BASSetup2."Calculate with" = 1 THEN
        Amount := -Amount;
      TotalAmount := TotalAmount + Amount;
    END;

    PROCEDURE InitializeRequest@1450002(VAR NewBASCalcSheet@1450000 : Record 11601;NewUpdateBASCalcSheet@1450001 : Boolean;NewSelection@1450002 : 'Open,Closed,Open and Closed';NewPeriodSelection@1450003 : 'Before and Within Period,Within Period';NewExcludeClosingEntries@1450004 : Boolean);
    BEGIN
      BASCalcSheet.COPY(NewBASCalcSheet);
      "BAS Setup".SETRANGE("Setup Name",BASCalcSheet."BAS Setup Name");
      UpdateBASCalcSheet := NewUpdateBASCalcSheet;
      Selection := NewSelection;
      PeriodSelection := NewPeriodSelection;
      ExcludeClosingEntries := NewExcludeClosingEntries;
    END;

    PROCEDURE InitializeSetupName@1450003(NewSetupName@1450000 : Code[20]);
    BEGIN
      SetupName := NewSetupName
    END;

    LOCAL PROCEDURE UpdateRequestForm@1450004();
    BEGIN
      PageUpdateRequestForm;
    END;

    PROCEDURE GetPeriodFilter@1450005(PeriodSelection2@1450000 : 'Before and Within Period,Within Period';A32@1450001 : Date;A42@1450002 : Date) : Text[250];
    BEGIN
      IF PeriodSelection2 = PeriodSelection2::"Before and Within Period" THEN
        EXIT(STRSUBSTNO('%1..%2',070100D,A42));

      EXIT(STRSUBSTNO('%1..%2',A32,A42));
    END;

    PROCEDURE CalcExportLineTotal@1500000(BASSetup2@1450000 : Record 11600;VAR TotalAmount@1450001 : Decimal;Level@1450002 : Integer;DocumentNo@1500000 : Code[11];VersionNo@1500001 : Integer) : Boolean;
    VAR
      GLEntry@1500004 : Record 17;
      VATEntry@1500003 : Record 254;
    BEGIN
      { first thing...
      BASSetup2.CALCFIELDS("Field Label No.");
      IF Level = 0 THEN BEGIN
        TotalAmount := 0;
        Amount := 0;
        CLEAR(RowNo);
        CLEAR(FieldLabelNo);
      END;
      BASCalcSheetEntry.RESET;
      BASCalcSheetEntry.SETCURRENTKEY(
        "Company Name",
        "BAS Document No.",
        "BAS Version",
        "Field Label No.",
        "GST Bus. Posting Group",
        "GST Prod. Posting Group",
        "BAS Adjustment");
      BASCalcSheetEntry.SETRANGE("Company Name",COMPANYNAME);
      BASCalcSheetEntry.SETRANGE("BAS Document No.",DocumentNo);
      BASCalcSheetEntry.SETRANGE("BAS Version",VersionNo);
      BASCalcSheetEntry.SETRANGE("Field Label No.",BASSetup2."Field Label No.");
      BASCalcSheetEntry.SETRANGE("GST Bus. Posting Group",BASSetup2."GST Bus. Posting Group");
      BASCalcSheetEntry.SETRANGE("GST Prod. Posting Group",BASSetup2."GST Prod. Posting Group");
      BASCalcSheetEntry.SETRANGE("BAS Adjustment",BASSetup2."BAS Adjustment");
      IF BASCalcSheetEntry.FIND('-') THEN
        REPEAT
          CASE BASSetup2."Amount Type" OF
            BASSetup2."Amount Type"::Amount:
              Amount := Amount + BASCalcSheetEntry.Amount;
            BASSetup2."Amount Type"::"GST Amount":
              Amount := Amount + BASCalcSheetEntry.Amount;
          END;
        UNTIL BASCalcSheetEntry.NEXT = 0;
      CalcTotalAmount(BASSetup2,TotalAmount);
      EXIT(TRUE);
      }
      BASSetup2.CALCFIELDS("Field Label No.");
      IF Level = 0 THEN BEGIN
        TotalAmount := 0;
        Amount := 0;
        CLEAR(RowNo);
        CLEAR(FieldLabelNo);
      END;
      CASE BASSetup2.Type OF
        BASSetup2.Type::"Account Totaling":
          BEGIN
            GLEntry.RESET;
            GLEntry.SETCURRENTKEY(
              "G/L Account No.",
              "BAS Adjustment",
              "VAT Bus. Posting Group",
              "VAT Prod. Posting Group",
              "Posting Date",
              "BAS Doc. No.");
            GLEntry.SETFILTER("G/L Account No.",BASSetup2."Account Totaling");
            GLEntry.SETRANGE("BAS Adjustment",BASSetup2."BAS Adjustment");
            GLEntry.SETRANGE("VAT Bus. Posting Group",BASSetup2."GST Bus. Posting Group");
            GLEntry.SETRANGE("VAT Prod. Posting Group",BASSetup2."GST Prod. Posting Group");
            GLEntry.SETFILTER(
              "Posting Date",
              GetPeriodFilter(PeriodSelection,BASCalcSheet.A3,BASCalcSheet.A4));
            GLEntry.SETRANGE("BAS Doc. No.",DocumentNo);
            IF BASSetup2."Account Totaling" <> '' THEN BEGIN
              IF GLEntry.FIND('-') THEN
                REPEAT
                  IF
                     (ExcludeClosingEntries AND
                      (GLEntry."Posting Date" = NORMALDATE(GLEntry."Posting Date"))) OR
                     (NOT ExcludeClosingEntries)
                  THEN BEGIN
                    BASCalcEntry1.RESET;
                    BASCalcEntry1.SETCURRENTKEY("Company Name",Type,"Entry No.","BAS Document No.","BAS Version");
                    BASCalcEntry1.SETRANGE("Company Name",COMPANYNAME);
                    BASCalcEntry1.SETRANGE(Type,BASCalcEntry1.Type::"G/L Entry");
                    BASCalcEntry1.SETRANGE("Entry No.",GLEntry."Entry No.");
                    BASCalcEntry1.SETRANGE("BAS Document No.",DocumentNo);
                    BASCalcEntry1.SETRANGE("BAS Version",VersionNo);
                    IF BASCalcEntry1.FINDFIRST THEN
                      CASE BASSetup2."Amount Type" OF
                        BASSetup2."Amount Type"::Amount:
                          Amount := Amount + GLEntry.Amount;
                        BASSetup2."Amount Type"::"GST Amount":
                          Amount := Amount + GLEntry."VAT Amount";
                      END;
                  END;
                UNTIL GLEntry.NEXT = 0;
            END;
            CalcTotalAmount(BASSetup2,TotalAmount);
          END;
        BASSetup2.Type::"GST Entry Totaling":
          BEGIN
            VATEntry.RESET;
            VATEntry.SETCURRENTKEY(
              Type,
              Closed,
              "BAS Adjustment",
              "VAT Bus. Posting Group",
              "VAT Prod. Posting Group",
              "Posting Date",
              "BAS Doc. No.");
            VATEntry.SETRANGE(Type,BASSetup2."Gen. Posting Type");
            CASE Selection OF
              Selection::Open:
                VATEntry.SETRANGE(Closed,FALSE);
              Selection::Closed:
                VATEntry.SETRANGE(Closed,TRUE);
            END;
            VATEntry.SETRANGE("BAS Adjustment",BASSetup2."BAS Adjustment");
            VATEntry.SETRANGE("VAT Bus. Posting Group",BASSetup2."GST Bus. Posting Group");
            VATEntry.SETRANGE("VAT Prod. Posting Group",BASSetup2."GST Prod. Posting Group");
            VATEntry.SETFILTER(
              "Posting Date",
              GetPeriodFilter(PeriodSelection,BASCalcSheet.A3,BASCalcSheet.A4));
            VATEntry.SETRANGE("BAS Doc. No.",DocumentNo);
            IF VATEntry.FIND('-') THEN
              REPEAT
                BASCalcEntry1.RESET;
                BASCalcEntry1.SETCURRENTKEY("Company Name",Type,"Entry No.","BAS Document No.","BAS Version");
                BASCalcEntry1.SETRANGE("Company Name",COMPANYNAME);
                BASCalcEntry1.SETRANGE(Type,BASCalcEntry1.Type::"GST Entry");
                BASCalcEntry1.SETRANGE("Entry No.",VATEntry."Entry No.");
                BASCalcEntry1.SETRANGE("BAS Document No.",DocumentNo);
                BASCalcEntry1.SETRANGE("BAS Version",VersionNo);
                IF BASCalcEntry1.FINDFIRST THEN
                  CASE BASSetup2."Amount Type" OF
                    BASSetup2."Amount Type"::Amount:
                      Amount := Amount + VATEntry.Amount;
                    BASSetup2."Amount Type"::Base:
                      Amount := Amount + VATEntry.Base;
                    BASSetup2."Amount Type"::"Unrealized Amount":
                      Amount := Amount + VATEntry."Unrealized Amount";
                    BASSetup2."Amount Type"::"Unrealized Base":
                      Amount := Amount + VATEntry."Unrealized Base";
                  END;

              UNTIL VATEntry.NEXT = 0;
            CalcTotalAmount(BASSetup2,TotalAmount);
          END;
        BASSetup2.Type::"Row Totaling":
          BEGIN
            IF Level >= ARRAYLEN(RowNo) THEN
              EXIT(FALSE);
            Level := Level + 1;
            RowNo[Level] := BASSetup2."Row No.";
            FieldLabelNo[Level] := BASSetup2."Field Label No.";

            IF BASSetup2."Row Totaling" = '' THEN
              EXIT(TRUE);
            BASSetup2.SETRANGE("Setup Name",BASSetup2."Setup Name");
            BASSetup2.SETFILTER("Row No.",BASSetup2."Row Totaling");
            IF BASSetup2.FIND('-') THEN
              REPEAT
                IF NOT CalcLineTotal(BASSetup2,TotalAmount,Level) THEN BEGIN
                  IF Level > 1 THEN
                    EXIT(FALSE);
                  FOR i := 1 TO ARRAYLEN(RowNo) DO
                    ErrorText := ErrorText + RowNo[i] + ' => ';
                  ErrorText := ErrorText + '...';
                  BASSetup2.FIELDERROR("Row No.",ErrorText);
                END;
              UNTIL BASSetup2.NEXT = 0;
          END;
      END;

      EXIT(TRUE);
    END;

    LOCAL PROCEDURE PageUpdateRequestForm@19031953();
    BEGIN
      ExcludeClosingEntriesEnable := PeriodSelection = PeriodSelection::"Before and Within Period";
      IF ExcludeClosingEntriesEnable = FALSE THEN
        ExcludeClosingEntries := FALSE;
    END;

    BEGIN
    END.
  }
  RDLDATA
  {
    <?xml version="1.0" encoding="utf-8"?>
<Report xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner" xmlns="http://schemas.microsoft.com/sqlserver/reporting/2010/01/reportdefinition">
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="DataSource">
      <ConnectionProperties>
        <DataProvider>SQL</DataProvider>
        <ConnectString />
      </ConnectionProperties>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>44dfdc7c-6588-40cc-9337-6279fea848ea</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="DataSet_Result">
      <Query>
        <DataSourceName>DataSource</DataSourceName>
        <CommandText />
      </Query>
      <Fields>
        <Field Name="FORMAT_TODAY_0_4_">
          <DataField>FORMAT_TODAY_0_4_</DataField>
        </Field>
        <Field Name="Heading">
          <DataField>Heading</DataField>
        </Field>
        <Field Name="CurrReport_PAGENO">
          <DataField>CurrReport_PAGENO</DataField>
        </Field>
        <Field Name="COMPANYNAME">
          <DataField>COMPANYNAME</DataField>
        </Field>
        <Field Name="USERID">
          <DataField>USERID</DataField>
        </Field>
        <Field Name="Heading2">
          <DataField>Heading2</DataField>
        </Field>
        <Field Name="SelectionTypeNo">
          <DataField>SelectionTypeNo</DataField>
        </Field>
        <Field Name="PageGroupNo">
          <DataField>PageGroupNo</DataField>
        </Field>
        <Field Name="BASSetupFilter">
          <DataField>BASSetupFilter</DataField>
        </Field>
        <Field Name="FirstPage">
          <DataField>FirstPage</DataField>
        </Field>
        <Field Name="HeaderText">
          <DataField>HeaderText</DataField>
        </Field>
        <Field Name="BAS_Setup__TABLECAPTION__________BASSetupFilter">
          <DataField>BAS_Setup__TABLECAPTION__________BASSetupFilter</DataField>
        </Field>
        <Field Name="BAS_Setup__Row_No__">
          <DataField>BAS_Setup__Row_No__</DataField>
        </Field>
        <Field Name="BAS_Setup__Field_Description_">
          <DataField>BAS_Setup__Field_Description_</DataField>
        </Field>
        <Field Name="TotalAmount">
          <DataField>TotalAmount</DataField>
        </Field>
        <Field Name="TotalAmountFormat">
          <DataField>TotalAmountFormat</DataField>
        </Field>
        <Field Name="BAS_Setup__Field_Label_No__">
          <DataField>BAS_Setup__Field_Label_No__</DataField>
        </Field>
        <Field Name="BAS_Setup_Setup_Name">
          <DataField>BAS_Setup_Setup_Name</DataField>
        </Field>
        <Field Name="BAS_Setup_Line_No_">
          <DataField>BAS_Setup_Line_No_</DataField>
        </Field>
        <Field Name="BAS_Calculation_Sheet___UpdateCaption">
          <DataField>BAS_Calculation_Sheet___UpdateCaption</DataField>
        </Field>
        <Field Name="CurrReport_PAGENOCaption">
          <DataField>CurrReport_PAGENOCaption</DataField>
        </Field>
        <Field Name="Amounts_are_in_whole_LCYs_Caption">
          <DataField>Amounts_are_in_whole_LCYs_Caption</DataField>
        </Field>
        <Field Name="The_report_includes_all_GST_entries_Caption">
          <DataField>The_report_includes_all_GST_entries_Caption</DataField>
        </Field>
        <Field Name="The_report_includes_only_closed_GST_entries_Caption">
          <DataField>The_report_includes_only_closed_GST_entries_Caption</DataField>
        </Field>
        <Field Name="BAS_Setup__Row_No__Caption">
          <DataField>BAS_Setup__Row_No__Caption</DataField>
        </Field>
        <Field Name="BAS_Setup__Field_Description_Caption">
          <DataField>BAS_Setup__Field_Description_Caption</DataField>
        </Field>
        <Field Name="TotalAmountCaption">
          <DataField>TotalAmountCaption</DataField>
        </Field>
        <Field Name="BAS_Setup__Field_Label_No__Caption">
          <DataField>BAS_Setup__Field_Label_No__Caption</DataField>
        </Field>
      </Fields>
      <rd:DataSetInfo>
        <rd:DataSetName>DataSet</rd:DataSetName>
        <rd:SchemaPath>Report.xsd</rd:SchemaPath>
        <rd:TableName>Result</rd:TableName>
      </rd:DataSetInfo>
    </DataSet>
  </DataSets>
  <ReportSections>
    <ReportSection>
      <Body>
        <ReportItems>
          <Tablix Name="Table1">
            <TablixBody>
              <TablixColumns>
                <TablixColumn>
                  <Width>1.65cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>2.1cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>3.8cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>3.85cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>1.8cm</Width>
                </TablixColumn>
                <TablixColumn>
                  <Width>4.95cm</Width>
                </TablixColumn>
              </TablixColumns>
              <TablixRows>
                <TablixRow>
                  <Height>0.423cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="HeaderText">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!HeaderText.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>5</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Heading">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!Heading.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <Style />
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="COMPANYNAME">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!COMPANYNAME.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <Style />
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Heading2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!Heading2.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <Style />
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.423cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="Amounts_are_in_whole_LCYs_Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!Amounts_are_in_whole_LCYs_Caption.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>4</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="BAS_Calculation_Sheet___UpdateCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!BAS_Calculation_Sheet___UpdateCaption.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <Style />
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="CurrReport_PAGENOCaption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!CurrReport_PAGENOCaption.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <Color>#ff0000</Color>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Visibility>
                            <Hidden>true</Hidden>
                          </Visibility>
                          <Style />
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.423cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="The_report_includes_all_GST_entries_Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!The_report_includes_all_GST_entries_Caption.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>3</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox2">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.423cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="The_report_includes_only_closed_GST_entries_Caption">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!The_report_includes_only_closed_GST_entries_Caption.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>2</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox3">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                        </Textbox>
                        <ColSpan>3</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.423cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox12">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                        </Textbox>
                        <ColSpan>6</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.423cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="BAS_Setup__TABLECAPTION__________BASSetupFilter">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!BAS_Setup__TABLECAPTION__________BASSetupFilter.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <ZIndex>1</ZIndex>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                          </Style>
                        </Textbox>
                        <ColSpan>6</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.423cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox13">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                        </Textbox>
                        <ColSpan>6</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                    <TablixCell />
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.423cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="BAS_Setup__Row_No__Caption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!BAS_Setup__Row_No__Caption.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="BAS_Setup__Field_Label_No__Caption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!BAS_Setup__Field_Label_No__Caption.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <VerticalAlign>Bottom</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="BAS_Setup__Field_Description_Caption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!BAS_Setup__Field_Description_Caption.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="TotalAmountCaption">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=First(Fields!TotalAmountCaption.Value, "DataSet_Result")</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <FontWeight>Bold</FontWeight>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Right</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox35">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox35</rd:DefaultName>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
                <TablixRow>
                  <Height>0.423cm</Height>
                  <TablixCells>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="BAS_Setup__Row_No__">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!BAS_Setup__Row_No__.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="BAS_Setup__Field_Label_No__">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!BAS_Setup__Field_Label_No__.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                              <Style>
                                <TextAlign>Left</TextAlign>
                              </Style>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="BAS_Setup__Field_Description_">
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Fields!BAS_Setup__Field_Description_.Value</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                        <ColSpan>2</ColSpan>
                      </CellContents>
                    </TablixCell>
                    <TablixCell />
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="TotalAmount">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value>=Code.BlankZero(Fields!TotalAmount.Value)</Value>
                                  <Style>
                                    <FontSize>7pt</FontSize>
                                    <Format>=Fields!TotalAmountFormat.Value</Format>
                                  </Style>
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <Style>
                            <VerticalAlign>Middle</VerticalAlign>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                    <TablixCell>
                      <CellContents>
                        <Textbox Name="textbox37">
                          <CanGrow>true</CanGrow>
                          <KeepTogether>true</KeepTogether>
                          <Paragraphs>
                            <Paragraph>
                              <TextRuns>
                                <TextRun>
                                  <Value />
                                  <Style />
                                </TextRun>
                              </TextRuns>
                            </Paragraph>
                          </Paragraphs>
                          <rd:DefaultName>textbox37</rd:DefaultName>
                          <Style>
                            <PaddingLeft>2pt</PaddingLeft>
                            <PaddingRight>2pt</PaddingRight>
                            <PaddingTop>2pt</PaddingTop>
                            <PaddingBottom>2pt</PaddingBottom>
                          </Style>
                        </Textbox>
                      </CellContents>
                    </TablixCell>
                  </TablixCells>
                </TablixRow>
              </TablixRows>
            </TablixBody>
            <TablixColumnHierarchy>
              <TablixMembers>
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
                <TablixMember />
              </TablixMembers>
            </TablixColumnHierarchy>
            <TablixRowHierarchy>
              <TablixMembers>
                <TablixMember>
                  <Group Name="Table1_Group1">
                    <GroupExpressions>
                      <GroupExpression>=Fields!PageGroupNo.Value</GroupExpression>
                    </GroupExpressions>
                    <PageBreak>
                      <BreakLocation>End</BreakLocation>
                    </PageBreak>
                  </Group>
                  <TablixMembers>
                    <TablixMember>
                      <Group Name="Table1_Group2">
                        <GroupExpressions>
                          <GroupExpression>=Fields!FirstPage.Value</GroupExpression>
                        </GroupExpressions>
                      </Group>
                      <TablixMembers>
                        <TablixMember>
                          <KeepWithGroup>After</KeepWithGroup>
                          <RepeatOnNewPage>true</RepeatOnNewPage>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                        <TablixMember>
                          <KeepWithGroup>After</KeepWithGroup>
                          <RepeatOnNewPage>true</RepeatOnNewPage>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                        <TablixMember>
                          <Visibility>
                            <Hidden>=Not(Fields!SelectionTypeNo.Value=2)</Hidden>
                          </Visibility>
                          <KeepWithGroup>After</KeepWithGroup>
                          <RepeatOnNewPage>true</RepeatOnNewPage>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                        <TablixMember>
                          <Visibility>
                            <Hidden>=Not(Fields!SelectionTypeNo.Value=1)</Hidden>
                          </Visibility>
                          <KeepWithGroup>After</KeepWithGroup>
                          <RepeatOnNewPage>true</RepeatOnNewPage>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                        <TablixMember>
                          <Visibility>
                            <Hidden>=Not(Fields!SelectionTypeNo.Value=1 OR Fields!SelectionTypeNo.Value=2)</Hidden>
                          </Visibility>
                          <KeepWithGroup>After</KeepWithGroup>
                          <RepeatOnNewPage>true</RepeatOnNewPage>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                        <TablixMember>
                          <Visibility>
                            <Hidden>=Not(Fields!FirstPage.Value AND Fields!BASSetupFilter.Value&lt;&gt;"")</Hidden>
                          </Visibility>
                          <KeepWithGroup>After</KeepWithGroup>
                          <RepeatOnNewPage>true</RepeatOnNewPage>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                        <TablixMember>
                          <KeepWithGroup>After</KeepWithGroup>
                          <RepeatOnNewPage>true</RepeatOnNewPage>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                        <TablixMember>
                          <KeepWithGroup>After</KeepWithGroup>
                          <RepeatOnNewPage>true</RepeatOnNewPage>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                        <TablixMember>
                          <Group Name="Table1_Details_Group">
                            <DataElementName>Detail</DataElementName>
                          </Group>
                          <TablixMembers>
                            <TablixMember />
                          </TablixMembers>
                          <DataElementName>Detail_Collection</DataElementName>
                          <DataElementOutput>Output</DataElementOutput>
                          <KeepTogether>true</KeepTogether>
                        </TablixMember>
                      </TablixMembers>
                    </TablixMember>
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixRowHierarchy>
            <DataSetName>DataSet_Result</DataSetName>
          </Tablix>
        </ReportItems>
        <Height>3.807cm</Height>
      </Body>
      <Width>18.15cm</Width>
      <Page>
        <PageHeader>
          <Height>2.538cm</Height>
          <PrintOnFirstPage>true</PrintOnFirstPage>
          <PrintOnLastPage>true</PrintOnLastPage>
          <ReportItems>
            <Textbox Name="PageNumberTextBox">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Globals!PageNumber</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                </Paragraph>
              </Paragraphs>
              <Top>0.423cm</Top>
              <Left>17.7cm</Left>
              <Height>0.423cm</Height>
              <ZIndex>7</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="UserIdTextBox">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=User!UserID</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Top>0.846cm</Top>
              <Left>15.9cm</Left>
              <Height>0.423cm</Height>
              <ZIndex>6</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="ExecutionTimeTextBox">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=Globals!ExecutionTime</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                        <Format>g</Format>
                      </Style>
                    </TextRun>
                  </TextRuns>
                  <Style>
                    <TextAlign>Right</TextAlign>
                  </Style>
                </Paragraph>
              </Paragraphs>
              <Left>15cm</Left>
              <Height>0.423cm</Height>
              <ZIndex>5</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Heading1">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=ReportItems!Heading.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                </Paragraph>
              </Paragraphs>
              <Top>0.423cm</Top>
              <Height>0.423cm</Height>
              <Width>7.5cm</Width>
              <ZIndex>4</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="COMPANYNAME1">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=ReportItems!COMPANYNAME.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                </Paragraph>
              </Paragraphs>
              <Top>1.269cm</Top>
              <Height>0.423cm</Height>
              <Width>7.5cm</Width>
              <ZIndex>3</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="Heading21">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=ReportItems!Heading2.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                </Paragraph>
              </Paragraphs>
              <Top>0.846cm</Top>
              <Height>0.423cm</Height>
              <Width>7.5cm</Width>
              <ZIndex>2</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="BAS_Calculation_Sheet___UpdateCaption1">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=ReportItems!BAS_Calculation_Sheet___UpdateCaption.Value</Value>
                      <Style>
                        <FontSize>8pt</FontSize>
                        <FontWeight>Bold</FontWeight>
                      </Style>
                    </TextRun>
                  </TextRuns>
                </Paragraph>
              </Paragraphs>
              <Height>0.423cm</Height>
              <Width>7.5cm</Width>
              <ZIndex>1</ZIndex>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
            <Textbox Name="CurrReport_PAGENOCaption1">
              <CanGrow>true</CanGrow>
              <KeepTogether>true</KeepTogether>
              <Paragraphs>
                <Paragraph>
                  <TextRuns>
                    <TextRun>
                      <Value>=ReportItems!CurrReport_PAGENOCaption.Value</Value>
                      <Style>
                        <FontSize>7pt</FontSize>
                      </Style>
                    </TextRun>
                  </TextRuns>
                </Paragraph>
              </Paragraphs>
              <Top>0.423cm</Top>
              <Left>16.95cm</Left>
              <Height>0.423cm</Height>
              <Width>0.75cm</Width>
              <Style>
                <VerticalAlign>Middle</VerticalAlign>
              </Style>
            </Textbox>
          </ReportItems>
        </PageHeader>
        <PageHeight>29.7cm</PageHeight>
        <PageWidth>21cm</PageWidth>
        <InteractiveHeight>11in</InteractiveHeight>
        <InteractiveWidth>8.5in</InteractiveWidth>
        <LeftMargin>1.5cm</LeftMargin>
        <RightMargin>0cm</RightMargin>
        <TopMargin>2cm</TopMargin>
        <BottomMargin>2cm</BottomMargin>
      </Page>
    </ReportSection>
  </ReportSections>
  <Code>Public Function BlankZero(ByVal Value As Decimal)
    if Value = 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankPos(ByVal Value As Decimal)
    if Value &gt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankZeroAndPos(ByVal Value As Decimal)
    if Value &gt;= 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNeg(ByVal Value As Decimal)
    if Value &lt; 0 then
        Return ""
    end if
    Return Value
End Function

Public Function BlankNegAndZero(ByVal Value As Decimal)
    if Value &lt;= 0 then
        Return ""
    end if
    Return Value
End Function
</Code>
  <Language>=User!Language</Language>
  <ConsumeContainerWhitespace>true</ConsumeContainerWhitespace>
  <rd:ReportUnitType>Invalid</rd:ReportUnitType>
  <rd:ReportID>ffed6456-724a-434b-bd55-64d252e8bfa3</rd:ReportID>
</Report>
    END_OF_RDLDATA
  }
}

