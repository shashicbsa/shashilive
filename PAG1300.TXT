OBJECT Page 1300 Mini Customer Card
{
  OBJECT-PROPERTIES
  {
    Date=09/23/13;
    Time=12:00:00;
    Version List=NAVW17.10;
  }
  PROPERTIES
  {
    CaptionML=[ENU=Customer Card;
               ENA=Customer Card];
    SourceTable=Table18;
    PageType=Card;
    RefreshOnActivate=Yes;
    PromotedActionCategoriesML=[ENU=New,Process,Report,New Document,Customer,History,Prices and Discounts,View,Help;
                                ENA=New,Process,Report,New Document,Customer,History,Prices and Discounts,View,Help];
    OnOpenPage=BEGIN
                 CurrPage.PriceAndLineDisc.PAGE.InitPage(FALSE);
                 ShowMainView := ShouldBeLoadedInSetupView;
                 ShowCharts := "No." <> '';
                 IF ShowCharts THEN
                   CurrPage.AgedAccReceivableChart.PAGE.SetPerCustomer;

                 SETFILTER("Date Filter",MiniCustomerMgt.GetCurrentYearFilter);
               END;

    OnAfterGetRecord=VAR
                       AgedAccReceivable@1000 : Codeunit 763;
                     BEGIN
                       BlockedCustomer := (Blocked = Blocked::All);
                       BalanceExhausted := 10000 <= CalcCreditLimitLCYExpendedPct;

                       DaysPastDueDate := AgedAccReceivable.InvoicePaymentDaysAverage("No.");
                       AttentionToPaidDay := DaysPastDueDate > 0;
                     END;

    OnNewRecord=BEGIN
                  ShowMainView := TRUE
                END;

    OnAfterGetCurrRecord=VAR
                           SalesPriceAndLineDiscBuff@1000 : Record 1304;
                         BEGIN
                           IF xRec."No." <> "No." THEN
                             ShowPricesAndLineDisc := SalesPriceAndLineDiscBuff.CustHasLines(Rec);

                           IF ShowPricesAndLineDisc THEN
                             GetSalesPricesAndSalesLineDisc;
                         END;

    ActionList=ACTIONS
    {
      { 1900000003;  ;ActionContainer;
                      ActionContainerType=ActionItems }
      { 3       ;1   ;ActionGroup;
                      Name=NewDocument;
                      CaptionML=[ENU=New Document;
                                 ENA=New Document] }
      { 1906384905;2 ;Action    ;
                      Name=NewSalesInvoice;
                      CaptionML=[ENU=Sales Invoice;
                                 ENA=Sales Invoice];
                      ToolTipML=[ENU=Create an invoice for the customer.;
                                 ENA=Create an invoice for the customer.];
                      Promoted=Yes;
                      Image=Invoice;
                      PromotedCategory=Category4;
                      RunPageMode=Create;
                      OnAction=BEGIN
                                 CreateAndShowNewInvoice;
                               END;
                                }
      { 88      ;2   ;Action    ;
                      Name=NewSalesQuote;
                      CaptionML=[ENU=Sales Quote;
                                 ENA=Sales Quote];
                      ToolTipML=[ENU=Create a quote for the customer.;
                                 ENA=Create a quote for the customer.];
                      Promoted=Yes;
                      Image=Quote;
                      PromotedCategory=Category4;
                      RunPageMode=Create;
                      OnAction=BEGIN
                                 CreateAndShowNewQuote;
                               END;
                                }
      { 1902583505;2 ;Action    ;
                      Name=NewSalesCreditMemo;
                      CaptionML=[ENU=Sales Credit Memo;
                                 ENA=Sales CR/Adj Note];
                      ToolTipML=[ENU=Create a credit memo for the customer.;
                                 ENA=Create a CR/Adj Note for the customer.];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CreditMemo;
                      PromotedCategory=Category4;
                      RunPageMode=Create;
                      OnAction=BEGIN
                                 CreateAndShowNewCreditMemo;
                               END;
                                }
      { 32      ;1   ;ActionGroup;
                      Name=Customer;
                      CaptionML=[ENU=Customer;
                                 ENA=Customer];
                      Image=Customer }
      { 20      ;2   ;Action    ;
                      Name=<Recurrent Sales Lines>;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Recurring Sales Lines;
                                 ENA=Recurring Sales Lines];
                      ToolTipML=[ENU=Set up recurring sales lines for the customer, such as a monthly replenishment order, that can quickly be inserted on a sales document for the customer.;
                                 ENA=Set up recurring sales lines for the customer, such as a monthly replenishment order, that can quickly be inserted on a sales document for the customer.];
                      RunObject=Page 1314;
                      RunPageLink=Customer No.=FIELD(No.);
                      PromotedIsBig=Yes;
                      Image=CustomerCode;
                      PromotedCategory=Category5 }
      { 29      ;2   ;Action    ;
                      CaptionML=[ENU=Bank Accounts;
                                 ENA=Bank Accounts];
                      ToolTipML=[ENU=Set up information about the customer's bank account.;
                                 ENA=Set up information about the customer's bank account.];
                      RunObject=Page 424;
                      RunPageLink=Customer No.=FIELD(No.);
                      PromotedIsBig=Yes;
                      Image=BankAccount;
                      PromotedCategory=Category5 }
      { 30      ;2   ;Action    ;
                      CaptionML=[ENU=Ship-&to Addresses;
                                 ENA=Ship-&to Addresses];
                      ToolTipML=[ENU=Set up the alternate address where the customer wants the item delivered if different from their regular address.;
                                 ENA=Set up the alternate address where the customer wants the item delivered if different from their regular address.];
                      RunObject=Page 301;
                      RunPageLink=Customer No.=FIELD(No.);
                      PromotedIsBig=Yes;
                      Image=ShipAddress;
                      PromotedCategory=Category5 }
      { 22      ;2   ;Action    ;
                      CaptionML=[ENU=Cross Re&ferences;
                                 ENA=Cross Re&ferences];
                      ToolTipML=[ENU=Set up the customer's own identification of items that you sell to the customer. Cross-references to the customer's item number means that their item number is automatically shown on sales documents instead of the number that you use.;
                                 ENA=Set up the customer's own identification of items that you sell to the customer. Cross-references to the customer's item number means that their item number is automatically shown on sales documents instead of the number that you use.];
                      RunObject=Page 5723;
                      RunPageView=SORTING(Cross-Reference Type,Cross-Reference Type No.);
                      RunPageLink=Cross-Reference Type=CONST(Customer),
                                  Cross-Reference Type No.=FIELD(No.);
                      PromotedIsBig=Yes;
                      Image=Change;
                      PromotedCategory=Category5 }
      { 18      ;2   ;Action    ;
                      CaptionML=[ENU=Online Map;
                                 ENA=Online Map];
                      ToolTipML=[ENU=View the customer's address on your preferred map website.;
                                 ENA=View the customer's address on your preferred map website.];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Map;
                      PromotedCategory=Category5;
                      OnAction=BEGIN
                                 DisplayMap;
                               END;
                                }
      { 31      ;2   ;Action    ;
                      ShortCutKey=Shift+Ctrl+D;
                      CaptionML=[ENU=Dimensions;
                                 ENA=Dimensions];
                      ToolTipML=[ENU=Set up default dimensions for the customer, such as an area or customer group code. You can assign dimension codes to transactions to distribute costs and analyze historical information.;
                                 ENA=Set up default dimensions for the customer, such as an area or customer group code. You can assign dimension codes to transactions to distribute costs and analyse historical information.];
                      RunObject=Page 540;
                      RunPageLink=Table ID=CONST(18),
                                  No.=FIELD(No.);
                      PromotedIsBig=Yes;
                      Image=Dimensions;
                      PromotedCategory=Category5 }
      { 5       ;1   ;ActionGroup;
                      Name=History;
                      CaptionML=[ENU=History;
                                 ENA=History];
                      Image=History }
      { 80      ;2   ;Action    ;
                      ShortCutKey=Ctrl+F7;
                      CaptionML=[ENU=Ledger E&ntries;
                                 ENA=Ledger E&ntries];
                      ToolTipML=[ENU=View the history of transactions for the customer.;
                                 ENA=View the history of transactions for the customer.];
                      RunObject=Page 25;
                      RunPageView=SORTING(Customer No.);
                      RunPageLink=Customer No.=FIELD(No.);
                      PromotedIsBig=Yes;
                      Image=CustomerLedger;
                      PromotedCategory=Category6 }
      { 76      ;1   ;ActionGroup;
                      Name=View;
                      CaptionML=[ENU=View;
                                 ENA=View] }
      { 49      ;2   ;Action    ;
                      Name=ShowMainView;
                      CaptionML=[ENU=Financial Details;
                                 ENA=Financial Details];
                      ToolTipML=[ENU=View core information for the customer, such as addresses, invoicing details, and payment details.;
                                 ENA=View core information for the customer, such as addresses, invoicing details, and payment details.];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=Setup;
                      PromotedCategory=Category8;
                      OnAction=BEGIN
                                 ShowMainView := NOT ShowMainView;
                               END;
                                }
      { 47      ;2   ;Action    ;
                      CaptionML=[ENU=Prices and Line Discounts;
                                 ENA=Prices and Line Discounts];
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=SalesLineDisc;
                      PromotedCategory=Category8;
                      OnAction=BEGIN
                                 ShowPricesAndLineDisc := NOT ShowPricesAndLineDisc;
                               END;
                                }
      { 82      ;1   ;ActionGroup;
                      Name=PricesandDiscounts;
                      CaptionML=[ENU=Prices and Discounts;
                                 ENA=Prices and Discounts];
                      Image=Sales }
      { 83      ;2   ;Action    ;
                      CaptionML=[ENU=Invoice &Discounts;
                                 ENA=Invoice &Discounts];
                      ToolTipML=[ENU=Set up different discounts that are applied to invoices for the customer. An invoice discount is automatically granted to the customer when the total on a sales invoice exceeds a certain amount.;
                                 ENA=Set up different discounts that are applied to invoices for the customer. An invoice discount is automatically granted to the customer when the total on a sales invoice exceeds a certain amount.];
                      RunObject=Page 23;
                      RunPageLink=Code=FIELD(Invoice Disc. Code);
                      Promoted=Yes;
                      PromotedIsBig=Yes;
                      Image=CalculateInvoiceDiscount;
                      PromotedCategory=Category7 }
      { 113     ;2   ;Action    ;
                      CaptionML=[ENU=Prices;
                                 ENA=Prices];
                      ToolTipML=[ENU=Set up different prices for items that you sell to the customer. An item price is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.;
                                 ENA=Set up different prices for items that you sell to the customer. An item price is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.];
                      RunObject=Page 7002;
                      RunPageView=SORTING(Sales Type,Sales Code);
                      RunPageLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.);
                      Image=Price }
      { 136     ;2   ;Action    ;
                      CaptionML=[ENU=Line Discounts;
                                 ENA=Line Discounts];
                      ToolTipML=[ENU=Set up different discounts for items that you sell to the customer. An item discount is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.;
                                 ENA=Set up different discounts for items that you sell to the customer. An item discount is automatically granted on invoice lines when the specified criteria are met, such as customer, quantity, or ending date.];
                      RunObject=Page 7004;
                      RunPageView=SORTING(Sales Type,Sales Code);
                      RunPageLink=Sales Type=CONST(Customer),
                                  Sales Code=FIELD(No.);
                      Image=LineDiscount }
      { 28      ;1   ;ActionGroup;
                      Name=DataTemplate;
                      CaptionML=[ENU=Data Template;
                                 ENA=Data Template] }
      { 167     ;2   ;Action    ;
                      Name=SaveAsTemplate;
                      Ellipsis=Yes;
                      CaptionML=[ENU=Save as Template;
                                 ENA=Save as Template];
                      ToolTipML=[ENU=Save the customer card as a template that can be reused to create new customer cards. Customer templates contain preset information to help you fill fields on customer cards.;
                                 ENA=Save the customer card as a template that can be reused to create new customer cards. Customer templates contain preset information to help you fill fields on customer cards.];
                      PromotedIsBig=Yes;
                      Image=Save;
                      PromotedCategory=New;
                      OnAction=VAR
                                 TempMiniCustomerTemplate@1000 : TEMPORARY Record 1300;
                               BEGIN
                                 TempMiniCustomerTemplate.SaveAsTemplate(Rec);
                               END;
                                }
      { 81      ;2   ;Action    ;
                      Name=Templates;
                      CaptionML=[ENU=Templates;
                                 ENA=Templates];
                      ToolTipML=[ENU=View or edit customer templates.;
                                 ENA=View or edit customer templates.];
                      RunObject=Page 1340;
                      RunPageView=WHERE(Table ID=CONST(18));
                      PromotedIsBig=Yes;
                      Image=Template }
      { 84      ;1   ;ActionGroup;
                      Name=Reports;
                      CaptionML=[ENU=Reports;
                                 ENA=Reports];
                      Image=Reports }
      { 85      ;2   ;ActionGroup;
                      Name=FinanceReports;
                      CaptionML=[ENU=Finance Reports;
                                 ENA=Finance Reports];
                      Image=Report }
      { 1906813206;3 ;Action    ;
                      Name=Report Customer Detailed Aging;
                      CaptionML=[ENU=Customer - Detailed Aging;
                                 ENA=Customer - Detailed Aging];
                      ToolTipML=[ENU=View, print, or save a detailed list of each customer's total payments due, divided into three time periods. The report can be used to decide when to issue reminders, to evaluate a customer's creditworthiness, or to prepare liquidity analyses.;
                                 ENA=View, print, or save a detailed list of each customer's total payments due, divided into three time periods. The report can be used to decide when to issue reminders, to evaluate a customer's creditworthiness, or to prepare liquidity analyses.];
                      Image=Report;
                      OnAction=VAR
                                 Customer@1001 : Record 18;
                               BEGIN
                                 Customer.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Customer Detailed Aging",TRUE,TRUE,Customer);
                               END;
                                }
      { 1902299006;3 ;Action    ;
                      Name=Report Customer - Balance to Date;
                      CaptionML=[ENU=Customer - Balance to Date;
                                 ENA=Customer - Balance to Date];
                      ToolTipML=[ENU=View, print, or save a list with customers' payment history up until a certain date. You can use the report to extract your total sales income at the close of an accounting period or fiscal year.;
                                 ENA=View, print, or save a list with customers' payment history up until a certain date. You can use the report to extract your total sales income at the close of an accounting period or fiscal year.];
                      Image=Report;
                      OnAction=VAR
                                 Customer@1001 : Record 18;
                               BEGIN
                                 Customer.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::"Customer - Balance to Date",TRUE,TRUE,Customer);
                               END;
                                }
      { 9       ;3   ;Action    ;
                      Name=Report Statement;
                      CaptionML=[ENU=Statement;
                                 ENA=Statement];
                      ToolTipML=[ENU=View, print, or save a list of a customer's transactions for a selected period, for example, to send to the customer at the close of an accounting period. You can choose to have all overdue balances displayed regardless of the period specified, or you can choose to include an aging band.;
                                 ENA=View, print, or save a list of a customer's transactions for a selected period, for example, to send to the customer at the close of an accounting period. You can choose to have all overdue balances displayed regardless of the period specified, or you can choose to include an aging band.];
                      Image=Report;
                      OnAction=VAR
                                 Customer@1000 : Record 18;
                               BEGIN
                                 Customer.SETRANGE("No.","No.");
                                 REPORT.RUNMODAL(REPORT::Statement,TRUE,TRUE,Customer);
                               END;
                                }
    }
  }
  CONTROLS
  {
    { 1900000001;0;Container;
                ContainerType=ContentArea }

    { 1   ;1   ;Group     ;
                CaptionML=[ENU=Customer;
                           ENA=Customer];
                GroupType=Group }

    { 26  ;2   ;Group     ;
                GroupType=Group }

    { 2   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the number of the customer. The field is either filled automatically from a defined number series, or you enter the number manually because you have enabled manual number entry in the number-series setup.;
                           ENA=Specifies the number of the customer. The field is either filled automatically from a defined number series, or you enter the number manually because you have enabled manual number entry in the number-series setup.];
                SourceExpr="No.";
                Importance=Promoted;
                OnAssistEdit=BEGIN
                               IF AssistEdit(xRec) THEN
                                 CurrPage.UPDATE;
                             END;
                              }

    { 4   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's name. You can enter a maximum of 30 characters, both numbers and letters.;
                           ENA=Specifies the customer's name. You can enter a maximum of 30 characters, both numbers and letters.];
                SourceExpr=Name;
                Importance=Promoted }

    { 23  ;3   ;Field     ;
                Name=<Blocked>;
                CaptionML=[ENU=Blocked;
                           ENA=Blocked];
                OptionCaptionML=[ENU=" ,,,All";
                                 ENA=" ,,,All"];
                SourceExpr=BlockedCustomer;
                OnValidate=BEGIN
                             IF BlockedCustomer THEN
                               Blocked := Blocked::All
                             ELSE
                               Blocked := Blocked::" ";
                           END;
                            }

    { 17  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies when the customer card was last modified.;
                           ENA=Specifies when the customer card was last modified.];
                SourceExpr="Last Date Modified" }

    { 63  ;2   ;Group     ;
                Editable=false;
                GroupType=Group }

    { 62  ;3   ;Field     ;
                Name=TotalSales2;
                CaptionML=[ENU=Total Sales;
                           ENA=Total Sales];
                ToolTipML=[ENU=Specifies your total sales turnover with the customer in the current fiscal year. It is calculated from amounts excluding VAT on all completed and open sales invoices and credit memos.;
                           ENA=Specifies your total sales turnover with the customer in the current fiscal year. It is calculated from amounts excluding GST on all completed and open sales invoices and CR/Adj Notes.];
                SourceExpr=GetTotalSales;
                Style=Strong;
                StyleExpr=TRUE }

    { 57  ;3   ;Field     ;
                CaptionML=[ENU=Costs (LCY);
                           ENA=Costs (LCY)];
                ToolTipML=[ENU=Specifies how much cost you have incurred from the customer in the current fiscal year. It is calculated as the sum of unit costs of all the goods you have sold to the customer. This includes any changes that occurred in your purchase prices of the goods.;
                           ENA=Specifies how much cost you have incurred from the customer in the current fiscal year. It is calculated as the sum of unit costs of all the goods you have sold to the customer. This includes any changes that occurred in your purchase prices of the goods.];
                SourceExpr=CustSalesLCY - CustProfit - AdjmtCostLCY;
                AutoFormatType=1 }

    { 45  ;3   ;Field     ;
                CaptionML=[ENU=Profit (LCY);
                           ENA=Profit (LCY)];
                ToolTipML=[ENU=Specifies how much profit you have made from the customer in the current fiscal year. The calculation takes into account any changes that occurred in purchase prices of the sold goods.;
                           ENA=Specifies how much profit you have made from the customer in the current fiscal year. The calculation takes into account any changes that occurred in purchase prices of the sold goods.];
                SourceExpr=AdjCustProfit;
                AutoFormatType=1 }

    { 51  ;3   ;Field     ;
                CaptionML=[ENU=Profit %;
                           ENA=Profit %];
                ToolTipML=[ENU=Specifies how much profit you have made from the customer in the current fiscal year, expressed as a percentage of the customer's total sales. The calculation takes into account any changes that occurred in purchase prices of the sold goods.;
                           ENA=Specifies how much profit you have made from the customer in the current fiscal year, expressed as a percentage of the customer's total sales. The calculation takes into account any changes that occurred in purchase prices of the sold goods.];
                DecimalPlaces=1:1;
                SourceExpr=AdjProfitPct }

    { 65  ;1   ;Group     ;
                CaptionML=[ENU=Address & Contact;
                           ENA=Address & Contact];
                GroupType=Group }

    { 19  ;2   ;Group     ;
                Name=AddressDetails;
                CaptionML=[ENU=Address;
                           ENA=Address];
                GroupType=Group }

    { 6   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's address. You can enter a maximum of 30 characters, both numbers and letters.;
                           ENA=Specifies the customer's address. You can enter a maximum of 30 characters, both numbers and letters.];
                SourceExpr=Address }

    { 8   ;3   ;Field     ;
                ToolTipML=[ENU=Specifies another line of the customer's address. You can enter a maximum of 30 characters, both numbers and letters.;
                           ENA=Specifies another line of the customer's address. You can enter a maximum of 30 characters, both numbers and letters.];
                SourceExpr="Address 2" }

    { 90  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's post code.;
                           ENA=Specifies the customer's post code.];
                SourceExpr="Post Code";
                Importance=Promoted }

    { 10  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's city.;
                           ENA=Specifies the customer's city.];
                SourceExpr=City }

    { 91  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies a country/region code for the customer. To see the country/region codes and address formats in the Countries/Regions window, click the field.;
                           ENA=Specifies a country/region code for the customer. To see the country/region codes and address formats in the Countries/Regions window, click the field.];
                SourceExpr="Country/Region Code" }

    { 21  ;2   ;Group     ;
                Name=ContactDetails;
                CaptionML=[ENU=Contact;
                           ENA=Contact];
                GroupType=Group }

    { 12  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's telephone number. You can enter a maximum of 30 characters, both numbers and letters.;
                           ENA=Specifies the customer's telephone number. You can enter a maximum of 30 characters, both numbers and letters.];
                SourceExpr="Phone No." }

    { 107 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's e-mail address. You can enter a maximum of 80 characters, both numbers and letters.;
                           ENA=Specifies the customer's e-mail address. You can enter a maximum of 80 characters, both numbers and letters.];
                SourceExpr="E-Mail";
                Importance=Promoted }

    { 109 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's home page address. You can enter a maximum of 80 characters, both numbers and letters.;
                           ENA=Specifies the customer's home page address. You can enter a maximum of 80 characters, both numbers and letters.];
                SourceExpr="Home Page" }

    { 16  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the name of the person you regularly contact when you do business with this customer. You can enter a maximum of 30 characters, both numbers and letters.;
                           ENA=Specifies the name of the person you regularly contact when you do business with this customer. You can enter a maximum of 30 characters, both numbers and letters.];
                SourceExpr=Contact;
                Importance=Promoted }

    { 1905885101;1;Group  ;
                Name=Invoicing;
                CaptionML=[ENU=Invoicing;
                           ENA=Invoicing];
                Visible=ShowMainView;
                GroupType=Group }

    { 64  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the maximum amount by which you allow the customer to exceed the payment balance before warnings are issued.;
                           ENA=Specifies the maximum amount by which you allow the customer to exceed the payment balance before warnings are issued.];
                SourceExpr="Credit Limit (LCY)" }

    { 25  ;2   ;Group     ;
                Name=PostingDetails;
                CaptionML=[ENU=Posting Details;
                           ENA=Posting Details];
                GroupType=Group }

    { 34  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies a different customer's number. To see the customer numbers in the Customer table, click the field.;
                           ENA=Specifies a different customer's number. To see the customer numbers in the Customer table, click the field.];
                SourceExpr="Bill-to Customer No.";
                LookupPageID=Mini Customer List;
                DrillDownPageID=Mini Customer List }

    { 70  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's trade type to link transactions made for this customer with the appropriate general ledger account according to the general posting setup.;
                           ENA=Specifies the customer's trade type to link transactions made for this customer with the appropriate general ledger account according to the general posting setup.];
                SourceExpr="Gen. Bus. Posting Group";
                Importance=Promoted }

    { 58  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's VAT specification to link transactions made for this customer with the appropriate general ledger account according to the VAT posting setup.;
                           ENA=Specifies the customer's GST specification to link transactions made for this customer with the appropriate general ledger account according to the GST posting setup.];
                SourceExpr="VAT Bus. Posting Group" }

    { 38  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's market type to link business transactions made for the customer with the appropriate account in the general ledger.;
                           ENA=Specifies the customer's market type to link business transactions made for the customer with the appropriate account in the general ledger.];
                SourceExpr="Customer Posting Group";
                Importance=Promoted }

    { 36  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies how many copies of a sales invoice for the customer will be printed at a time. For example, enter 2 if you always keep a copy in your files in addition to the one that you send to the customer.;
                           ENA=Specifies how many copies of a sales invoice for the customer will be printed at a time. For example, enter 2 if you always keep a copy in your files in addition to the one that you send to the customer.];
                SourceExpr="Invoice Copies" }

    { 27  ;2   ;Group     ;
                Name=PricesandDiscounts;
                CaptionML=[ENU=Prices and Discounts;
                           ENA=Prices and Discounts];
                GroupType=Group }

    { 40  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer price group code, which you can use as a criterion to set up special sales prices in the Sales Prices window.;
                           ENA=Specifies the customer price group code, which you can use as a criterion to set up special sales prices in the Sales Prices window.];
                SourceExpr="Customer Price Group";
                Importance=Promoted }

    { 44  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer discount group code, which you can use as a criterion to set up special discounts in the Sales Line Discounts window.;
                           ENA=Specifies the customer discount group code, which you can use as a criterion to set up special discounts in the Sales Line Discounts window.];
                SourceExpr="Customer Disc. Group";
                Importance=Promoted }

    { 46  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies if a sales line discount is calculated when a special sales price is offered according to setup in the Sales Prices window.;
                           ENA=Specifies if a sales line discount is calculated when a special sales price is offered according to setup in the Sales Prices window.];
                SourceExpr="Allow Line Disc." }

    { 129 ;3   ;Field     ;
                ToolTipML=[ENU=Specifies if the Unit Price and Line Amount fields on sales lines for this customer should be shown with or without VAT.;
                           ENA=Specifies if the Unit Price and Line Amount fields on sales lines for this customer should be shown with or without GST.];
                SourceExpr="Prices Including VAT" }

    { 1907468901;2;Group  ;
                Name=ForeignTrade;
                CaptionML=[ENU=Foreign Trade;
                           ENA=Foreign Trade];
                GroupType=Group }

    { 67  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies a default currency code for the customer.;
                           ENA=Specifies a default currency code for the customer.];
                SourceExpr="Currency Code";
                Importance=Promoted }

    { 66  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the language to be used on printouts for this customer.;
                           ENA=Specifies the language to be used on printouts for this customer.];
                SourceExpr="Language Code" }

    { 69  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies the customer's VAT registration number. You can enter a maximum of 20 characters, both numbers and letters.;
                           ENA=Specifies the customer's Exemption Certificate number. You can enter a maximum of 20 characters, both numbers and letters.];
                SourceExpr="VAT Registration No." }

    { 1901677601;1;Group  ;
                Name=Payments;
                CaptionML=[ENU=Payments;
                           ENA=Payments];
                Visible=ShowMainView;
                GroupType=Group }

    { 48  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how to apply payments to entries for this customer. Select Manual to manually specify the document that a payment applies to. This is the default method. Select Apply to Oldest to automatically apply payments to the oldest open customer ledger entry.;
                           ENA=Specifies how to apply payments to entries for this customer. Select Manual to manually specify the document that a payment applies to. This is the default method. Select Apply to Oldest to automatically apply payments to the oldest open customer ledger entry.];
                SourceExpr="Application Method" }

    { 50  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies a code that indicates the payment terms that you require of the customer. The payment terms code you define in this field is inserted on sales invoices for the customer.;
                           ENA=Specifies a code that indicates the payment terms that you require of the customer. The payment terms code you define in this field is inserted on sales invoices for the customer.];
                SourceExpr="Payment Terms Code";
                Importance=Promoted }

    { 11  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how the customer usually submits payment, such as bank transfer or check. The payment method code that you select in this field is inserted on sales invoices for the customer.;
                           ENA=Specifies how the customer usually submits payment, such as bank transfer or cheque. The payment method code that you select in this field is inserted on sales invoices for the customer.];
                SourceExpr="Payment Method Code";
                Importance=Promoted }

    { 15  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies how reminders about late payments are handled for this customer.;
                           ENA=Specifies how reminders about late payments are handled for this customer.];
                SourceExpr="Reminder Terms Code";
                Importance=Promoted }

    { 52  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies finance charges are calculated for the customer. A finance charge terms code contains information about the interest calculation method, interest rate, and so on.;
                           ENA=Specifies finance charges are calculated for the customer. A finance charge terms code contains information about the interest calculation method, interest rate, and so on.];
                SourceExpr="Fin. Charge Terms Code";
                Importance=Promoted }

    { 54  ;2   ;Field     ;
                ToolTipML=[ENU=Specifies whether to include this customer when you print the Statement report.;
                           ENA=Specifies whether to include this customer when you print the Statement report.];
                SourceExpr="Print Statements" }

    { 60  ;2   ;Field     ;
                ToolTipML=[ENU=Shows the number of the last statement that was printed for this customer.;
                           ENA=Shows the number of the last statement that was printed for this customer.];
                SourceExpr="Last Statement No." }

    { 143 ;2   ;Field     ;
                ToolTipML=[ENU=Specifies that the customer is not allowed payment tolerance.;
                           ENA=Specifies that the customer is not allowed payment tolerance.];
                SourceExpr="Block Payment Tolerance" }

    { 7   ;2   ;Field     ;
                ToolTipML=[ENU=Specifies the customer bank account that will be used by default when you process refunds to the customer.;
                           ENA=Specifies the customer bank account that will be used by default when you process refunds to the customer.];
                SourceExpr="Preferred Bank Account" }

    { 56  ;1   ;Group     ;
                Name=Statistics;
                CaptionML=[ENU=Statistics;
                           ENA=Statistics];
                Editable=false;
                GroupType=Group }

    { 55  ;2   ;Group     ;
                Name=Balance;
                GroupType=Group }

    { 53  ;3   ;Field     ;
                CaptionML=[ENU=Money Owed - Current;
                           ENA=Money Owed - Current];
                ToolTipML=[ENU=Specifies the payment amount that the customer owes for completed sales. This value is also known as the customer's balance.;
                           ENA=Specifies the payment amount that the customer owes for completed sales. This value is also known as the customer's balance.];
                SourceExpr="Balance (LCY)" }

    { 68  ;3   ;Field     ;
                CaptionML=[ENU=Money Owed - Expected;
                           ENA=Money Owed - Expected];
                ToolTipML=[ENU=Specifies the payment amount that the customer will owe when ongoing sales invoices and credit memos are completed.;
                           ENA=Specifies the payment amount that the customer will owe when ongoing sales invoices and CR/Adj Notes are completed.];
                SourceExpr=GetMoneyOwedExpected;
                OnDrillDown=BEGIN
                              MiniCustomerMgt.DrillDownMoneyOwedExpected("No.");
                            END;
                             }

    { 43  ;3   ;Field     ;
                CaptionML=[ENU=Money Owed - Total;
                           ENA=Money Owed - Total];
                ToolTipML=[ENU=Specifies the payment amount that the customer owes for completed sales plus sales that are still ongoing. The value is the sum of the values in the Money Owed - Current and Money Owed - Expected fields.;
                           ENA=Specifies the payment amount that the customer owes for completed sales plus sales that are still ongoing. The value is the sum of the values in the Money Owed - Current and Money Owed - Expected fields.];
                SourceExpr="Balance (LCY)" + GetMoneyOwedExpected;
                Style=Strong;
                StyleExpr=TRUE }

    { 42  ;3   ;Field     ;
                Name=CreditLimit;
                CaptionML=[ENU=Credit Limit;
                           ENA=Credit Limit];
                ToolTipML=[ENU=Specifies the maximum amount by which you allow the customer to exceed the payment balance before warnings are issued.;
                           ENA=Specifies the maximum amount by which you allow the customer to exceed the payment balance before warnings are issued.];
                SourceExpr="Credit Limit (LCY)" }

    { 41  ;3   ;Field     ;
                ExtendedDatatype=Ratio;
                CaptionML=[ENU=Usage Of Credit Limit;
                           ENA=Usage Of Credit Limit];
                ToolTipML=[ENU=Specifies how much of the customer's payment balance consists of credit. The gauge shows the value in the Money Owed - Total field as a percentage of the value in the Credit Limit field.;
                           ENA=Specifies how much of the customer's payment balance consists of credit. The gauge shows the value in the Money Owed - Total field as a percentage of the value in the Credit Limit field.];
                SourceExpr=CalcCreditLimitLCYExpendedPct;
                Style=Attention;
                StyleExpr=BalanceExhausted }

    { 39  ;2   ;Group     ;
                CaptionML=[ENU=Payments;
                           ENA=Payments];
                GroupType=Group }

    { 37  ;3   ;Field     ;
                Name=Balance Due;
                ToolTipML=[ENU=Specifies payments from the customer that are overdue per today's date.;
                           ENA=Specifies payments from the customer that are overdue per today's date.];
                SourceExpr=CalcOverdueBalance;
                CaptionClass=FORMAT(STRSUBSTNO(OverduePaymentsCap,FORMAT(WORKDATE)));
                OnDrillDown=VAR
                              DtldCustLedgEntry@1000 : Record 379;
                              CustLedgEntry@1001 : Record 21;
                            BEGIN
                              DtldCustLedgEntry.SETFILTER("Customer No.","No.");
                              COPYFILTER("Global Dimension 1 Filter",DtldCustLedgEntry."Initial Entry Global Dim. 1");
                              COPYFILTER("Global Dimension 2 Filter",DtldCustLedgEntry."Initial Entry Global Dim. 2");
                              COPYFILTER("Currency Filter",DtldCustLedgEntry."Currency Code");
                              CustLedgEntry.DrillDownOnOverdueEntries(DtldCustLedgEntry);
                            END;
                             }

    { 35  ;3   ;Field     ;
                CaptionML=[ENU=Payments This Year;
                           ENA=Payments This Year];
                ToolTipML=[ENU=Specifies the sum of payments received from the customer in the current fiscal year.;
                           ENA=Specifies the sum of payments received from the customer in the current fiscal year.];
                SourceExpr="Payments (LCY)" }

    { 33  ;3   ;Field     ;
                CaptionML=[ENU=Average Collection Period (Days);
                           ENA=Average Collection Period (Days)];
                ToolTipML=[ENU=Specifies how long the customer typically takes to pay invoices in the current fiscal year. This is the average number of days from which invoices are issued until the customer pays the invoice.;
                           ENA=Specifies how long the customer typically takes to pay invoices in the current fiscal year. This is the average number of days from which invoices are issued until the customer pays the invoice.];
                DecimalPlaces=0:1;
                SourceExpr=MiniCustomerMgt.AvgDaysToPay("No.") }

    { 79  ;3   ;Field     ;
                Name=DaysPaidPastDueDate;
                CaptionML=[ENU=Average Late Payments (Days);
                           ENA=Average Late Payments (Days)];
                ToolTipML=[ENU=Specifies the average number of days the customer is late with payments.;
                           ENA=Specifies the average number of days the customer is late with payments.];
                DecimalPlaces=0:1;
                SourceExpr=DaysPastDueDate;
                Style=Attention;
                StyleExpr=AttentionToPaidDay }

    { 59  ;2   ;Group     ;
                CaptionML=[ENU=Sales This Year;
                           ENA=Sales This Year];
                GroupType=Group }

    { 61  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies your sales to the customer in the current fiscal year based on completed sales invoices. The figure in parenthesis shows the number of invoices.;
                           ENA=Specifies your sales to the customer in the current fiscal year based on completed sales invoices. The figure in parenthesis shows the number of invoices.];
                SourceExpr=GetAmountOnPostedInvoices;
                CaptionClass=STRSUBSTNO(PostedInvoicesCap,FORMAT(NoPostedInvoices));
                OnDrillDown=BEGIN
                              MiniCustomerMgt.DrillDownOnPostedInvoices("No.")
                            END;
                             }

    { 71  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies your refunds to the customer in the current fiscal year based on completed sales credit memos. The figure in parenthesis shows the number of credit memos.;
                           ENA=Specifies your refunds to the customer in the current fiscal year based on completed sales CR/Adj Notes. The figure in parenthesis shows the number of CR/Adj Notes.];
                SourceExpr=GetAmountOnCrMemo;
                CaptionClass=STRSUBSTNO(CreditMemosCap,FORMAT(NoPostedCrMemos));
                OnDrillDown=BEGIN
                              MiniCustomerMgt.DrillDownOnPostedCrMemo("No.")
                            END;
                             }

    { 72  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies your expected sales to the customer in the current fiscal year based on open sales invoices. The figure in parenthesis shows the number of open invoices.;
                           ENA=Specifies your expected sales to the customer in the current fiscal year based on open sales invoices. The figure in parenthesis shows the number of open invoices.];
                SourceExpr=GetAmountOnOutstandingInvoices;
                CaptionClass=STRSUBSTNO(OutstandingInvoicesCap,FORMAT(NoOutstandingInvoices));
                OnDrillDown=BEGIN
                              MiniCustomerMgt.DrillDownOnOutstandingInvoices("No.")
                            END;
                             }

    { 73  ;3   ;Field     ;
                ToolTipML=[ENU=Specifies your expected refunds to the customer in the current fiscal year based on open sales credit memos. The figure in parenthesis shows the number of open credit memos.;
                           ENA=Specifies your expected refunds to the customer in the current fiscal year based on open sales CR/Adj Notes. The figure in parenthesis shows the number of open CR/Adj Notes.];
                SourceExpr=GetAmountOnOutstandingCrMemos;
                CaptionClass=STRSUBSTNO(OutstandingCrMemosCap,FORMAT(NoOutstandingCrMemos));
                OnDrillDown=BEGIN
                              MiniCustomerMgt.DrillDownOnOutstandingCrMemos("No.")
                            END;
                             }

    { 74  ;3   ;Field     ;
                CaptionML=[ENU=Invoice Discounts;
                           ENA=Invoice Discounts];
                ToolTipML=[ENU=Specifies the total of all invoice discounts that you have granted to the customer in the current fiscal year.;
                           ENA=Specifies the total of all invoice discounts that you have granted to the customer in the current fiscal year.];
                SourceExpr=CustInvDiscAmountLCY }

    { 75  ;3   ;Field     ;
                CaptionML=[ENU=Total Sales;
                           ENA=Total Sales];
                ToolTipML=[ENU=Specifies your total sales turnover with the customer in the current fiscal year. It is calculated from amounts excluding VAT on all completed and open sales invoices and credit memos.;
                           ENA=Specifies your total sales turnover with the customer in the current fiscal year. It is calculated from amounts excluding GST on all completed and open sales invoices and CR/Adj Notes.];
                SourceExpr=Totals;
                Style=Strong;
                StyleExpr=TRUE }

    { 24  ;2   ;Part      ;
                Name=AgedAccReceivableChart;
                SubPageLink=No.=FIELD(No.);
                PagePartID=Page768;
                Visible=ShowCharts;
                PartType=Page }

    { 86  ;1   ;Part      ;
                Name=PriceAndLineDisc;
                PagePartID=Page1345;
                Visible=ShowPricesAndLineDisc;
                PartType=Page }

    { 13  ;1   ;Field     ;
                Name=PageReady;
                ControlAddIn=[Microsoft.Dynamics.Nav.Client.PageReady;PublicKeyToken=31bf3856ad364e35] }

  }
  CODE
  {
    VAR
      MiniCustomerMgt@1000 : Codeunit 1302;
      BlockedCustomer@1007 : Boolean;
      ShowMainView@1002 : Boolean;
      OverduePaymentsCap@1005 : TextConst '@@@=Overdue Payments as of 27-02-2012;ENU=Overdue Payments as of %1;ENA=Overdue Payments as of %1';
      ShowPricesAndLineDisc@1003 : Boolean;
      ShowCharts@1028 : Boolean INDATASET;
      CustSalesLCY@1010 : Decimal;
      AdjmtCostLCY@1024 : Decimal;
      AdjCustProfit@1009 : Decimal;
      CustProfit@1011 : Decimal;
      AdjProfitPct@1008 : Decimal;
      CustInvDiscAmountLCY@1006 : Decimal;
      CustPaymentsLCY@1004 : Decimal;
      BalanceExhausted@1012 : Boolean;
      PostedInvoicesCap@1014 : TextConst '@@@=Invoices (5);ENU=Invoices (%1);ENA=Invoices (%1)';
      CreditMemosCap@1015 : TextConst '@@@=Credit Memos (3);ENU=Credit Memos (%1);ENA=CR/Adj Notes (%1)';
      OutstandingInvoicesCap@1016 : TextConst '@@@=Outstanding Invoices (4);ENU=Outstanding Invoices (%1);ENA=Outstanding Invoices (%1)';
      NoPostedInvoices@1018 : Integer;
      NoPostedCrMemos@1017 : Integer;
      NoOutstandingInvoices@1020 : Integer;
      NoOutstandingCrMemos@1019 : Integer;
      AmountOnPostedInvoices@1021 : Decimal;
      AmountOnPostedCrMemos@1013 : Decimal;
      OutstandingCrMemosCap@1022 : TextConst 'ENU=Outstanding Credit Memos (%1);ENA=Outstanding CR/Adj Notes (%1)';
      AmountOnOutstandingInvoices@1023 : Decimal;
      AmountOnOutstandingCrMemos@1001 : Decimal;
      Totals@1025 : Decimal;
      DaysPastDueDate@1026 : Decimal;
      AttentionToPaidDay@1027 : Boolean;

    LOCAL PROCEDURE GetTotalSales@6() : Decimal;
    BEGIN
      NoPostedInvoices := 0;
      NoPostedCrMemos := 0;
      NoOutstandingInvoices := 0;
      NoOutstandingCrMemos := 0;
      Totals := 0;

      AmountOnPostedInvoices := MiniCustomerMgt.CalcAmountsOnPostedInvoices("No.",NoPostedInvoices);
      AmountOnPostedCrMemos := MiniCustomerMgt.CalcAmountsOnPostedCrMemos("No.",NoPostedCrMemos);

      AmountOnOutstandingInvoices := MiniCustomerMgt.CalculateAmountsOnUnpostedInvoices("No.",NoOutstandingInvoices);
      AmountOnOutstandingCrMemos := MiniCustomerMgt.CalculateAmountsOnUnpostedCrMemos("No.",NoOutstandingCrMemos);

      Totals := AmountOnPostedInvoices + AmountOnPostedCrMemos + AmountOnOutstandingInvoices + AmountOnOutstandingCrMemos;

      MiniCustomerMgt.CalculateStatistic(
        Rec,
        AdjmtCostLCY,AdjCustProfit,AdjProfitPct,
        CustInvDiscAmountLCY,CustPaymentsLCY,CustSalesLCY,
        CustProfit);
      EXIT(Totals)
    END;

    LOCAL PROCEDURE GetAmountOnPostedInvoices@5() : Decimal;
    BEGIN
      EXIT(AmountOnPostedInvoices)
    END;

    LOCAL PROCEDURE GetAmountOnCrMemo@8() : Decimal;
    BEGIN
      EXIT(AmountOnPostedCrMemos)
    END;

    LOCAL PROCEDURE GetAmountOnOutstandingInvoices@9() : Decimal;
    BEGIN
      EXIT(AmountOnOutstandingInvoices)
    END;

    LOCAL PROCEDURE GetAmountOnOutstandingCrMemos@10() : Decimal;
    BEGIN
      EXIT(AmountOnOutstandingCrMemos)
    END;

    LOCAL PROCEDURE GetMoneyOwedExpected@11() : Decimal;
    BEGIN
      EXIT(MiniCustomerMgt.CalculateAmountsWithVATOnUnpostedDocuments("No."))
    END;

    LOCAL PROCEDURE GetSalesPricesAndSalesLineDisc@4();
    BEGIN
      IF "No." <> CurrPage.PriceAndLineDisc.PAGE.GetLoadedCustNo THEN BEGIN
        CurrPage.PriceAndLineDisc.PAGE.LoadCustomer(Rec);
        CurrPage.PriceAndLineDisc.PAGE.UPDATE(FALSE);
      END;
    END;

    LOCAL PROCEDURE ShouldBeLoadedInSetupView@2() : Boolean;
    BEGIN
      EXIT('' IN [Address,
                  "Post Code",
                  City,
                  "Customer Posting Group",
                  "Gen. Bus. Posting Group",
                  "VAT Bus. Posting Group"]);
    END;

    EVENT PageReady@-13::AddInReady@0();
    VAR
      MiniCustomerTemplate@1000 : Record 1300;
      NewCustomerCode@1001 : Code[20];
    BEGIN
      IF "No." = '' THEN BEGIN
        NewCustomerCode := MiniCustomerTemplate.NewCustomerFromTemplate;
        IF NewCustomerCode <> '' THEN BEGIN
          GET(NewCustomerCode);
          CurrPage.UPDATE;
        END;
      END;
    END;

    BEGIN
    END.
  }
}

