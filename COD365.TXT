OBJECT Codeunit 365 Format Address
{
  OBJECT-PROPERTIES
  {
    Date=09/23/13;
    Time=12:00:00;
    Version List=NAVW17.10,NAVAPAC7.10;
  }
  PROPERTIES
  {
    OnRun=BEGIN
          END;

  }
  CODE
  {
    VAR
      GLSetup@1000 : Record 98;
      BarCode@1500001 : ARRAY [50] OF Text[100];

    PROCEDURE FormatAddr@1(VAR AddrArray@1000 : ARRAY [8] OF Text[90];Name@1001 : Text[90];Name2@1002 : Text[90];Contact@1003 : Text[90];Addr@1004 : Text[50];Addr2@1005 : Text[50];City@1006 : Text[50];PostCode@1007 : Code[20];County@1008 : Text[50];CountryCode@1009 : Code[10]);
    VAR
      Country@1010 : Record 9;
      InsertText@1011 : Integer;
      Index@1012 : Integer;
      NameLineNo@1013 : Integer;
      Name2LineNo@1014 : Integer;
      AddrLineNo@1015 : Integer;
      Addr2LineNo@1016 : Integer;
      ContLineNo@1017 : Integer;
      PostCodeCityLineNo@1018 : Integer;
      CountyLineNo@1019 : Integer;
      CountryLineNo@1020 : Integer;
    BEGIN
      CLEAR(AddrArray);

      IF CountryCode = '' THEN BEGIN
        GLSetup.GET;
        CLEAR(Country);
        Country."Address Format" := GLSetup."Local Address Format";
        Country."Contact Address Format" := GLSetup."Local Cont. Addr. Format";
      END ELSE
        Country.GET(CountryCode);

      CASE Country."Contact Address Format" OF
        Country."Contact Address Format"::First:
          BEGIN
            NameLineNo := 2;
            Name2LineNo := 3;
            ContLineNo := 1;
            AddrLineNo := 4;
            Addr2LineNo := 5;
            PostCodeCityLineNo := 6;
            CountyLineNo := 7;
            CountryLineNo := 8;
          END;
        Country."Contact Address Format"::"After Company Name":
          BEGIN
            NameLineNo := 1;
            Name2LineNo := 2;
            ContLineNo := 3;
            AddrLineNo := 4;
            Addr2LineNo := 5;
            PostCodeCityLineNo := 6;
            CountyLineNo := 7;
            CountryLineNo := 8;
          END;
        Country."Contact Address Format"::Last:
          BEGIN
            NameLineNo := 1;
            Name2LineNo := 2;
            ContLineNo := 8;
            AddrLineNo := 3;
            Addr2LineNo := 4;
            PostCodeCityLineNo := 5;
            CountyLineNo := 6;
            CountryLineNo := 7;
          END;
      END;

      AddrArray[NameLineNo] := Name;
      AddrArray[Name2LineNo] := Name2;
      AddrArray[AddrLineNo] := Addr;
      AddrArray[Addr2LineNo] := Addr2;

      CASE Country."Address Format" OF
        Country."Address Format"::"Post Code+City",
        Country."Address Format"::"City+County+Post Code",
        Country."Address Format"::"City+Post Code",
        Country."Address Format"::"City+Post Code (no comma)",
        Country."Address Format"::"City+County+Post Code (no comma)":
          BEGIN
            AddrArray[ContLineNo] := Contact;
            GeneratePostCodeCity(AddrArray[PostCodeCityLineNo],AddrArray[CountyLineNo],City,PostCode,County,Country);
            AddrArray[CountryLineNo] := Country.Name;
            COMPRESSARRAY(AddrArray);
          END;
        Country."Address Format"::"Blank Line+Post Code+City":
          BEGIN
            IF ContLineNo < PostCodeCityLineNo THEN
              AddrArray[ContLineNo] := Contact;
            COMPRESSARRAY(AddrArray);

            Index := 1;
            InsertText := 1;
            REPEAT
              IF AddrArray[Index] = '' THEN BEGIN
                CASE InsertText OF
                  2:
                    GeneratePostCodeCity(AddrArray[Index],AddrArray[Index + 1],City,PostCode,County,Country);
                  3:
                    AddrArray[Index] := Country.Name;
                  4:
                    IF ContLineNo > PostCodeCityLineNo THEN
                      AddrArray[Index] := Contact;
                END;
                InsertText := InsertText + 1;
              END;
              Index := Index + 1;
            UNTIL Index = 9;
          END;
      END;
    END;

    PROCEDURE FormatPostCodeCity@30(VAR PostCodeCityText@1000 : Text[90];VAR CountyText@1001 : Text[50];City@1002 : Text[50];PostCode@1003 : Code[20];County@1004 : Text[50];CountryCode@1005 : Code[10]);
    VAR
      Country@1006 : Record 9;
    BEGIN
      CLEAR(PostCodeCityText);
      CLEAR(CountyText);

      IF CountryCode = '' THEN BEGIN
        GLSetup.GET;
        CLEAR(Country);
        Country."Address Format" := GLSetup."Local Address Format";
        Country."Contact Address Format" := GLSetup."Local Cont. Addr. Format";
      END ELSE
        Country.GET(CountryCode);

      GeneratePostCodeCity(PostCodeCityText,CountyText,City,PostCode,County,Country);
    END;

    LOCAL PROCEDURE GeneratePostCodeCity@31(VAR PostCodeCityText@1000 : Text[90];VAR CountyText@1001 : Text[50];City@1002 : Text[50];PostCode@1003 : Code[20];County@1004 : Text[50];Country@1005 : Record 9);
    BEGIN
      CASE Country."Address Format" OF
        Country."Address Format"::"Post Code+City":
          BEGIN
            IF PostCode <> '' THEN
              PostCodeCityText := DELSTR(PostCode + ' ' + City,MAXSTRLEN(PostCodeCityText) + 1)
            ELSE
              PostCodeCityText := City;
            CountyText := County;
          END;
        Country."Address Format"::"City+County+Post Code":
          BEGIN
            IF (County <> '') AND (PostCode <> '') THEN
              PostCodeCityText :=
                DELSTR(City,MAXSTRLEN(PostCodeCityText) - STRLEN(PostCode) - STRLEN(County) - 3) +
                ', ' + County + '  ' + PostCode
            ELSE
              IF PostCode = '' THEN BEGIN
                PostCodeCityText := City;
                CountyText := County;
              END ELSE
                IF (County = '') AND (PostCode <> '') THEN
                  PostCodeCityText := DELSTR(City,MAXSTRLEN(PostCodeCityText) - STRLEN(PostCode) - 1) + ', ' + PostCode;
          END;
        Country."Address Format"::"City+Post Code":
          BEGIN
            IF PostCode <> '' THEN
              PostCodeCityText := DELSTR(City,MAXSTRLEN(PostCodeCityText) - STRLEN(PostCode) - 1) + ', ' + PostCode
            ELSE
              PostCodeCityText := City;
            CountyText := County;
          END;
        Country."Address Format"::"City+Post Code (no comma)":
          BEGIN
            IF PostCode <> '' THEN
              PostCodeCityText := DELSTR(City,MAXSTRLEN(PostCodeCityText) - STRLEN(PostCode) - 1) + ' ' + PostCode
            ELSE
              PostCodeCityText := City;
          END;
        Country."Address Format"::"City+County+Post Code (no comma)":
          BEGIN
            IF (County <> '') AND (PostCode <> '') THEN
              PostCodeCityText :=
                DELSTR(City,MAXSTRLEN(PostCodeCityText) - STRLEN(PostCode) - STRLEN(County) - 3) +
                ' ' + County + '  ' + PostCode
            ELSE
              IF PostCode = '' THEN BEGIN
                PostCodeCityText := City;
                CountyText := County;
              END ELSE
                IF (County = '') AND (PostCode <> '') THEN
                  PostCodeCityText := DELSTR(City,MAXSTRLEN(PostCodeCityText) - STRLEN(PostCode) - 1) + ' ' + PostCode;
          END;
        Country."Address Format"::"Blank Line+Post Code+City":
          BEGIN
            IF PostCode <> '' THEN
              PostCodeCityText := DELSTR(PostCode + ' ' + City,MAXSTRLEN(PostCodeCityText) + 1)
            ELSE
              PostCodeCityText := City;
            CountyText := County;
          END;
      END;
    END;

    PROCEDURE Company@2(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR CompanyInfo@1001 : Record 79);
    BEGIN
      WITH CompanyInfo DO BEGIN
        FormatAddr(
          AddrArray,Name,"Name 2",'',Address,"Address 2",
          City,"Post Code",County,'');
        CreateBarCode(
          DATABASE::"Company Information",GETPOSITION,0,'','','');
      END;
    END;

    PROCEDURE Customer@3(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR Cust@1001 : Record 18);
    BEGIN
      WITH Cust DO BEGIN
        FormatAddr(
          AddrArray,Name,"Name 2",Contact,Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::Customer,GETPOSITION,0,
          "No.","Global Dimension 1 Code","Global Dimension 2 Code");
      END;
    END;

    PROCEDURE Vendor@4(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR Vend@1001 : Record 23);
    BEGIN
      WITH Vend DO BEGIN
        FormatAddr(
          AddrArray,Name,"Name 2",Contact,Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::Vendor,GETPOSITION,0,
          "No.","Global Dimension 1 Code","Global Dimension 2 Code");
      END;
    END;

    PROCEDURE BankAcc@5(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR BankAcc@1001 : Record 270);
    BEGIN
      WITH BankAcc DO BEGIN
        FormatAddr(
          AddrArray,Name,"Name 2",Contact,Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::"Bank Account",GETPOSITION,0,
          "No.","Global Dimension 1 Code","Global Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesHeaderSellTo@6(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesHeader@1001 : Record 36);
    BEGIN
      WITH SalesHeader DO BEGIN
        FormatAddr(
          AddrArray,"Sell-to Customer Name","Sell-to Customer Name 2","Sell-to Contact","Sell-to Address","Sell-to Address 2",
          "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Header",GETPOSITION,3,
          "Sell-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesHeaderBillTo@7(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesHeader@1001 : Record 36);
    BEGIN
      WITH SalesHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesHeaderShipTo@8(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesHeader@1001 : Record 36);
    BEGIN
      WITH SalesHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchHeaderBuyFrom@9(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchHeader@1001 : Record 38);
    BEGIN
      WITH PurchHeader DO BEGIN
        FormatAddr(
          AddrArray,"Buy-from Vendor Name","Buy-from Vendor Name 2","Buy-from Contact","Buy-from Address","Buy-from Address 2",
          "Buy-from City","Buy-from Post Code","Buy-from County","Buy-from Country/Region Code");
        CreateBarCode(
          DATABASE::"Purchase Header",GETPOSITION,5,
          "Buy-from Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchHeaderPayTo@10(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchHeader@1001 : Record 38);
    BEGIN
      WITH PurchHeader DO BEGIN
        FormatAddr(
          AddrArray,"Pay-to Name","Pay-to Name 2","Pay-to Contact","Pay-to Address","Pay-to Address 2",
          "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purchase Header",GETPOSITION,4,
          "Pay-to Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchHeaderShipTo@11(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchHeader@1001 : Record 38);
    BEGIN
      WITH PurchHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purchase Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesShptSellTo@12(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesShptHeader@1001 : Record 110);
    BEGIN
      WITH SalesShptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Sell-to Customer Name","Sell-to Customer Name 2","Sell-to Contact","Sell-to Address","Sell-to Address 2",
          "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Shipment Header",GETPOSITION,3,
          "Sell-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesShptBillTo@13(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesShptHeader@1001 : Record 110);
    BEGIN
      WITH SalesShptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Shipment Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesShptShipTo@14(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesShptHeader@1001 : Record 110);
    BEGIN
      WITH SalesShptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Shipment Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesInvSellTo@15(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesInvHeader@1001 : Record 112);
    BEGIN
      WITH SalesInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Sell-to Customer Name","Sell-to Customer Name 2","Sell-to Contact","Sell-to Address","Sell-to Address 2",
          "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Invoice Header",GETPOSITION,3,
          "Sell-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesInvBillTo@16(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesInvHeader@1001 : Record 112);
    BEGIN
      WITH SalesInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Invoice Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesInvShipTo@17(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesInvHeader@1001 : Record 112);
    BEGIN
      WITH SalesInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Invoice Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesCrMemoSellTo@18(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesCrMemoHeader@1001 : Record 114);
    BEGIN
      WITH SalesCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Sell-to Customer Name","Sell-to Customer Name 2","Sell-to Contact","Sell-to Address","Sell-to Address 2",
          "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Cr.Memo Header",GETPOSITION,3,
          "Sell-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesCrMemoBillTo@19(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesCrMemoHeader@1001 : Record 114);
    BEGIN
      WITH SalesCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Cr.Memo Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesCrMemoShipTo@20(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesCrMemoHeader@1001 : Record 114);
    BEGIN
      WITH SalesCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Cr.Memo Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesRcptSellTo@5803(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ReturnRcptHeader@1001 : Record 6660);
    BEGIN
      WITH ReturnRcptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Sell-to Customer Name","Sell-to Customer Name 2","Sell-to Contact","Sell-to Address","Sell-to Address 2",
          "Sell-to City","Sell-to Post Code","Sell-to County","Sell-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Return Receipt Header",GETPOSITION,3,
          "Sell-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesRcptBillTo@5804(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ReturnRcptHeader@1001 : Record 6660);
    BEGIN
      WITH ReturnRcptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Return Receipt Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE SalesRcptShipTo@5805(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ReturnRcptHeader@1001 : Record 6660);
    BEGIN
      WITH ReturnRcptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Return Receipt Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchRcptBuyFrom@21(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchRcptHeader@1001 : Record 120);
    BEGIN
      WITH PurchRcptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Buy-from Vendor Name","Buy-from Vendor Name 2","Buy-from Contact","Buy-from Address","Buy-from Address 2",
          "Buy-from City","Buy-from Post Code","Buy-from County","Buy-from Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Rcpt. Header",GETPOSITION,5,
          "Buy-from Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchRcptPayTo@22(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchRcptHeader@1001 : Record 120);
    BEGIN
      WITH PurchRcptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Pay-to Name","Pay-to Name 2","Pay-to Contact","Pay-to Address","Pay-to Address 2",
          "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Rcpt. Header",GETPOSITION,4,
          "Pay-to Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchRcptShipTo@23(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchRcptHeader@1001 : Record 120);
    BEGIN
      WITH PurchRcptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Rcpt. Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchInvBuyFrom@24(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchInvHeader@1001 : Record 122);
    BEGIN
      WITH PurchInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Buy-from Vendor Name","Buy-from Vendor Name 2","Buy-from Contact","Buy-from Address","Buy-from Address 2",
          "Buy-from City","Buy-from Post Code","Buy-from County","Buy-from Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Inv. Header",GETPOSITION,5,
          "Buy-from Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchInvPayTo@25(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchInvHeader@1001 : Record 122);
    BEGIN
      WITH PurchInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Pay-to Name","Pay-to Name 2","Pay-to Contact","Pay-to Address","Pay-to Address 2",
          "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Inv. Header",GETPOSITION,4,
          "Pay-to Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchInvShipTo@26(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchInvHeader@1001 : Record 122);
    BEGIN
      WITH PurchInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Inv. Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchCrMemoBuyFrom@27(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchCrMemoHeader@1001 : Record 124);
    BEGIN
      WITH PurchCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Buy-from Vendor Name","Buy-from Vendor Name 2","Buy-from Contact","Buy-from Address","Buy-from Address 2",
          "Buy-from City","Buy-from Post Code","Buy-from County","Buy-from Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Cr. Memo Hdr.",GETPOSITION,5,
          "Buy-from Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchCrMemoPayTo@28(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchCrMemoHeader@1001 : Record 124);
    BEGIN
      WITH PurchCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Pay-to Name","Pay-to Name 2","Pay-to Contact","Pay-to Address","Pay-to Address 2",
          "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Cr. Memo Hdr.",GETPOSITION,4,
          "Pay-to Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchCrMemoShipTo@29(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchCrMemoHeader@1001 : Record 124);
    BEGIN
      WITH PurchCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Cr. Memo Hdr.",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchShptBuyFrom@5800(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ReturnShptHeader@1001 : Record 6650);
    BEGIN
      WITH ReturnShptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Buy-from Vendor Name","Buy-from Vendor Name 2","Buy-from Contact","Buy-from Address","Buy-from Address 2",
          "Buy-from City","Buy-from Post Code","Buy-from County","Buy-from Country/Region Code");
        CreateBarCode(
          DATABASE::"Return Shipment Header",GETPOSITION,5,
          "Buy-from Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchShptPayTo@5801(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ReturnShptHeader@1001 : Record 6650);
    BEGIN
      WITH ReturnShptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Pay-to Name","Pay-to Name 2","Pay-to Contact","Pay-to Address","Pay-to Address 2",
          "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Return Shipment Header",GETPOSITION,4,
          "Pay-to Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE PurchShptShipTo@5802(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ReturnShptHeader@1001 : Record 6650);
    BEGIN
      WITH ReturnShptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Return Shipment Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE AltAddr@34(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR Employee@1001 : Record 5200;VAR AlternativeAddr@1002 : Record 5201);
    BEGIN
      WITH AlternativeAddr DO BEGIN
        FormatAddr(
          AddrArray,COPYSTR(Employee.FullName,1,50),'','',Address,
          "Address 2",City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::"Alternative Address",GETPOSITION,0,'','','');
      END;
    END;

    PROCEDURE Employee@33(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR Employee@1001 : Record 5200);
    BEGIN
      WITH Employee DO BEGIN
        FormatAddr(
          AddrArray,COPYSTR(FullName,1,50),'','',Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::Employee,GETPOSITION,0,
          "No.","Global Dimension 1 Code","Global Dimension 2 Code");
      END;
    END;

    PROCEDURE EmployeeAltAddr@32(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR Employee@1001 : Record 5200);
    VAR
      AlternativeAddr@1002 : Record 5201;
    BEGIN
      AlternativeAddr.GET(Employee."No.",Employee."Alt. Address Code");
      WITH AlternativeAddr DO BEGIN
        FormatAddr(
          AddrArray,COPYSTR(Employee.FullName,1,50),'','',Address,
          "Address 2",City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::"Alternative Address",GETPOSITION,0,'','','');
      END;
    END;

    PROCEDURE VendBankAcc@37(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR VendBankAcc@1001 : Record 288);
    BEGIN
      WITH VendBankAcc DO BEGIN
        FormatAddr(
          AddrArray,Name,"Name 2",Contact,Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::"Vendor Bank Account",GETPOSITION,0,"Vendor No.",'','');
      END;
    END;

    PROCEDURE CustBankAcc@38(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR CustBankAcc@1001 : Record 287);
    BEGIN
      WITH CustBankAcc DO BEGIN
        FormatAddr(
          AddrArray,Name,"Name 2",Contact,Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::"Customer Bank Account",GETPOSITION,0,"Customer No.",'','');
      END;
    END;

    PROCEDURE RespCenter@40(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR RespCenter@1001 : Record 5714);
    BEGIN
      WITH RespCenter DO BEGIN
        FormatAddr(
          AddrArray,Name,"Name 2",Contact,Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::"Responsibility Center",GETPOSITION,0,
          Code,"Global Dimension 1 Code","Global Dimension 2 Code");
      END;
    END;

    PROCEDURE TransferShptTransferFrom@35(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR TransShptHeader@1001 : Record 5744);
    BEGIN
      WITH TransShptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Transfer-from Name","Transfer-from Name 2",'',"Transfer-from Address","Transfer-from Address 2",
          "Transfer-from City","Transfer-from Post Code","Transfer-from County","Trsf.-from Country/Region Code");
        CreateBarCode(
          DATABASE::"Transfer Shipment Header",GETPOSITION,6,
          "No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE TransferShptTransferTo@36(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR TransShptHeader@1001 : Record 5744);
    BEGIN
      WITH TransShptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Transfer-to Name","Transfer-to Name 2",'',"Transfer-to Address","Transfer-to Address 2",
          "Transfer-to City","Transfer-to Post Code","Transfer-to County","Trsf.-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Transfer Shipment Header",GETPOSITION,7,
          "No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE TransferRcptTransferFrom@41(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR TransRcptHeader@1001 : Record 5746);
    BEGIN
      WITH TransRcptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Transfer-from Name","Transfer-from Name 2",'',"Transfer-from Address","Transfer-from Address 2",
          "Transfer-from City","Transfer-from Post Code","Transfer-from County","Trsf.-from Country/Region Code");
        CreateBarCode(
          DATABASE::"Transfer Receipt Header",GETPOSITION,6,
          "No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE TransferRcptTransferTo@39(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR TransRcptHeader@1001 : Record 5746);
    BEGIN
      WITH TransRcptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Transfer-to Name","Transfer-to Name 2",'',"Transfer-to Address","Transfer-to Address 2",
          "Transfer-to City","Transfer-to Post Code","Transfer-to County","Trsf.-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Transfer Receipt Header",GETPOSITION,7,
          "No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE TransferHeaderTransferFrom@43(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR TransHeader@1001 : Record 5740);
    BEGIN
      WITH TransHeader DO BEGIN
        FormatAddr(
          AddrArray,"Transfer-from Name","Transfer-from Name 2",'',"Transfer-from Address","Transfer-from Address 2",
          "Transfer-from City","Transfer-from Post Code","Transfer-from County","Trsf.-from Country/Region Code");
        CreateBarCode(
          DATABASE::"Transfer Header",GETPOSITION,6,
          "No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE TransferHeaderTransferTo@42(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR TransHeader@1001 : Record 5740);
    BEGIN
      WITH TransHeader DO BEGIN
        FormatAddr(
          AddrArray,"Transfer-to Name","Transfer-to Name 2",'',"Transfer-to Address","Transfer-to Address 2",
          "Transfer-to City","Transfer-to Post Code","Transfer-to County","Trsf.-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Transfer Header",GETPOSITION,7,
          "No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE ContactAddr@45(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR Cont@1001 : Record 5050);
    BEGIN
      ContactAddrAlt(AddrArray,Cont,Cont.ActiveAltAddress(WORKDATE),WORKDATE)
    END;

    PROCEDURE ContactAddrAlt@44(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR Cont@1001 : Record 5050;AltAddressCode@1002 : Code[10];ActiveDate@1003 : Date);
    VAR
      RMSetup@1004 : Record 5079;
      ContCompany@1005 : Record 5050;
      ContAltAddr@1006 : Record 5051;
      CompanyAltAddressCode@1007 : Code[10];
      ContIdenticalAddress@1008 : Boolean;
    BEGIN
      RMSetup.GET;

      IF (Cont.Type = Cont.Type::Person) AND (Cont."Company No." <> '') THEN BEGIN
        ContCompany.GET(Cont."Company No.");
        CompanyAltAddressCode := ContCompany.ActiveAltAddress(ActiveDate);
        ContIdenticalAddress := Cont.IdenticalAddress(ContCompany);
      END;

      CASE TRUE OF
        AltAddressCode <> '':
          WITH ContAltAddr DO BEGIN
            GET(Cont."No.",AltAddressCode);
            FormatAddr(
              AddrArray,"Company Name","Company Name 2",Cont.Name,Address,"Address 2",
              City,"Post Code",County,"Country/Region Code");
            CreateBarCode(
              DATABASE::"Contact Alt. Address",GETPOSITION,0,
              "Contact No.",'','');
          END;
        (Cont.Type = Cont.Type::Person) AND
        (Cont."Company No." <> '') AND
        (CompanyAltAddressCode <> '') AND
        RMSetup."Inherit Address Details" AND
        ContIdenticalAddress:
          WITH ContAltAddr DO BEGIN
            GET(Cont."Company No.",CompanyAltAddressCode);
            FormatAddr(
              AddrArray,"Company Name","Company Name 2",Cont.Name,Address,"Address 2",
              City,"Post Code",County,"Country/Region Code");
            CreateBarCode(
              DATABASE::"Contact Alt. Address",GETPOSITION,0,
              "Contact No.",'','');
          END;
        (Cont.Type = Cont.Type::Person) AND
        (Cont."Company No." <> ''):
          WITH Cont DO BEGIN
            FormatAddr(
              AddrArray,ContCompany.Name,ContCompany."Name 2",Name,Address,"Address 2",
              City,"Post Code",County,"Country/Region Code");
            CreateBarCode(DATABASE::Contact,GETPOSITION,0,"No.",'','');
          END;
        ELSE
          WITH Cont DO BEGIN
            FormatAddr(
              AddrArray,Name,"Name 2",'',Address,"Address 2",
              City,"Post Code",County,"Country/Region Code");
            CreateBarCode(DATABASE::Contact,GETPOSITION,0,"No.",'','');
          END;
      END;
    END;

    PROCEDURE ServiceOrderSellto@47(VAR AddrArray@1000 : ARRAY [8] OF Text[50];ServHeader@1001 : Record 5900);
    BEGIN
      WITH ServHeader DO BEGIN
        FormatAddr(
          AddrArray,Name,"Name 2","Contact Name",Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Header",GETPOSITION,3,
          "Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE ServiceOrderShipto@53(VAR AddrArray@1000 : ARRAY [8] OF Text[50];ServHeader@1001 : Record 5900);
    BEGIN
      WITH ServHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE ServContractSellto@50(VAR AddrArray@1000 : ARRAY [8] OF Text[50];ServContract@1001 : Record 5965);
    BEGIN
      WITH ServContract DO BEGIN
        CALCFIELDS(Name,"Name 2",Address,"Address 2","Post Code",City,County,"Country/Region Code");
        FormatAddr(
          AddrArray,Name,"Name 2","Contact Name",Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Contract Header",GETPOSITION,3,
          "Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE ServContractShipto@52(VAR AddrArray@1000 : ARRAY [8] OF Text[50];ServContract@1001 : Record 5965);
    BEGIN
      WITH ServContract DO BEGIN
        CALCFIELDS(
          "Ship-to Name","Ship-to Name 2","Ship-to Address","Ship-to Address 2",
          "Ship-to Post Code","Ship-to City","Ship-to County","Ship-to Country/Region Code");
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Contact Name","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Contract Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END;
    END;

    PROCEDURE ServiceInvBillTo@49(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ServiceInvHeader@1001 : Record 5992);
    BEGIN
      WITH ServiceInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Invoice Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE ServiceInvShipTo@51(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ServiceInvHeader@1001 : Record 5992);
    BEGIN
      WITH ServiceInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Invoice Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE ServiceShptShipTo@54(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ServiceShptHeader@1001 : Record 5990);
    BEGIN
      WITH ServiceShptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Shipment Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE ServiceShptSellTo@56(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ServiceShptHeader@1001 : Record 5990);
    BEGIN
      WITH ServiceShptHeader DO BEGIN
        FormatAddr(
          AddrArray,Name,"Name 2","Contact Name",Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Shipment Header",GETPOSITION,3,
          "Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE ServiceShptBillTo@55(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ServiceShptHeader@1001 : Record 5990);
    BEGIN
      WITH ServiceShptHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Shipment Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE ServiceCrMemoBillTo@58(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ServiceCrMemoHeader@1001 : Record 5994);
    BEGIN
      WITH ServiceCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Cr.Memo Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE ServiceCrMemoShipTo@57(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ServiceCrMemoHeader@1001 : Record 5994);
    BEGIN
      WITH ServiceCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Cr.Memo Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE ServiceHeaderSellTo@61(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ServiceHeader@1001 : Record 5900);
    BEGIN
      WITH ServiceHeader DO BEGIN
        FormatAddr(
          AddrArray,Name,"Name 2","Contact No.",Address,"Address 2",
          City,"Post Code",County,"Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Header",GETPOSITION,3,
          "Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE ServiceHeaderBillTo@60(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ServiceHeader@1001 : Record 5900);
    BEGIN
      WITH ServiceHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE ServiceHeaderShipTo@59(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR ServiceHeader@1001 : Record 5900);
    BEGIN
      WITH ServiceHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Service Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    LOCAL PROCEDURE CreateBarCode@1500000(TableNo@1500005 : Integer;TableKey@1500004 : Text[1024];AddressType@1500003 : Option;CustomInfo1@1500002 : Code[20];CustomInfo2@1500001 : Code[20];CustomInfo3@1500000 : Code[20]);
    VAR
      AddressID@1500008 : Record 28003;
      BarCodeManagement@1500007 : Codeunit 28001;
      CustomInfo@1500006 : Code[20];
    BEGIN
      BarCode[AddressType + 1] := '';
      IF AddressID.GET(TableNo,TableKey,AddressType) THEN
        CASE AddressID."Bar Code System" OF
          AddressID."Bar Code System"::"4-State Bar Code":
            BEGIN
              CASE GLSetup."BarCode Custom Information" OF
                GLSetup."BarCode Custom Information"::" ":
                  CustomInfo := '';
                GLSetup."BarCode Custom Information"::Code:
                  CustomInfo := CustomInfo1;
                GLSetup."BarCode Custom Information"::"Global Dimension 1 Code":
                  CustomInfo := CustomInfo2;
                GLSetup."BarCode Custom Information"::"Global Dimension 2 Code":
                  CustomInfo := CustomInfo3;
              END;
              IF STRLEN(CustomInfo) > 15 THEN
                CustomInfo := '';
              BarCodeManagement.BuildBarCode(AddressID."Address ID",CustomInfo,BarCode[AddressType + 1]);
            END;
          ELSE
            BarCode[AddressType + 1] := AddressID."Bar Code";
        END;
    END;

    PROCEDURE PrintBarCode@1500001(AddressType@1500000 : Option) : Text[100];
    BEGIN
      EXIT(BarCode[AddressType + 1]);
    END;

    PROCEDURE SalesTaxInvBillTo@1500002(VAR AddrArray@1500001 : ARRAY [8] OF Text[50];VAR SalesTaxInvHeader@1500000 : Record 28071);
    BEGIN
      WITH SalesTaxInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Tax Invoice Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE SalesTaxInvShipTo@1500003(VAR AddrArray@1500001 : ARRAY [8] OF Text[50];VAR SalesTaxInvHeader@1500000 : Record 28071);
    BEGIN
      WITH SalesTaxInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Tax Invoice Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE SalesTaxCrMemoBillTo@1500004(VAR AddrArray@1500001 : ARRAY [8] OF Text[50];VAR SalesTaxCrMemoHeader@1500000 : Record 28073);
    BEGIN
      WITH SalesTaxCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Tax Cr.Memo Header",GETPOSITION,1,
          "Bill-to Customer No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE SalesTaxCrMemoShipTo@1500005(VAR AddrArray@1500001 : ARRAY [8] OF Text[50];VAR SalesTaxCrMemoHeader@1500000 : Record 28073);
    BEGIN
      WITH SalesTaxCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Sales Tax Cr.Memo Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE PurchTaxInvPayTo@1500006(VAR AddrArray@1500001 : ARRAY [8] OF Text[50];VAR PurchTaxInvHeader@1500000 : Record 28075);
    BEGIN
      WITH PurchTaxInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Pay-to Name","Pay-to Name 2","Pay-to Contact","Pay-to Address","Pay-to Address 2",
          "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Tax Inv. Header",GETPOSITION,4,
          "Pay-to Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE PurchTaxInvShipTo@1500007(VAR AddrArray@1500001 : ARRAY [8] OF Text[50];VAR PurchTaxInvHeader@1500000 : Record 28075);
    BEGIN
      WITH PurchTaxInvHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Tax Inv. Header",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE PurchTaxCrMemoPayTo@1500008(VAR AddrArray@1500001 : ARRAY [8] OF Text[50];VAR PurchTaxCrMemoHeader@1500000 : Record 28077);
    BEGIN
      WITH PurchTaxCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Pay-to Name","Pay-to Name 2","Pay-to Contact","Pay-to Address","Pay-to Address 2",
          "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Tax Cr. Memo Hdr.",GETPOSITION,4,
          "Pay-to Vendor No.","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE PurchTaxCrMemoShipTo@1500009(VAR AddrArray@1500001 : ARRAY [8] OF Text[50];VAR PurchTaxCrMemoHeader@1500000 : Record 28077);
    BEGIN
      WITH PurchTaxCrMemoHeader DO BEGIN
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
        CreateBarCode(
          DATABASE::"Purch. Tax Cr. Memo Hdr.",GETPOSITION,2,
          "Ship-to Code","Shortcut Dimension 1 Code","Shortcut Dimension 2 Code");
      END
    END;

    PROCEDURE SalesHeaderArchBillTo@46(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesHeaderArch@1001 : Record 5107);
    BEGIN
      WITH SalesHeaderArch DO
        FormatAddr(
          AddrArray,"Bill-to Name","Bill-to Name 2","Bill-to Contact","Bill-to Address","Bill-to Address 2",
          "Bill-to City","Bill-to Post Code","Bill-to County","Bill-to Country/Region Code");
    END;

    PROCEDURE SalesHeaderArchShipTo@48(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR SalesHeaderArch@1001 : Record 5107);
    BEGIN
      WITH SalesHeaderArch DO
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
    END;

    PROCEDURE PurchHeaderBuyFromArch@62(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchHeaderArch@1001 : Record 5109);
    BEGIN
      WITH PurchHeaderArch DO
        FormatAddr(
          AddrArray,"Buy-from Vendor Name","Buy-from Vendor Name 2","Buy-from Contact","Buy-from Address","Buy-from Address 2",
          "Buy-from City","Buy-from Post Code","Buy-from County","Buy-from Country/Region Code");
    END;

    PROCEDURE PurchHeaderPayToArch@64(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchHeaderArch@1001 : Record 5109);
    BEGIN
      WITH PurchHeaderArch DO
        FormatAddr(
          AddrArray,"Pay-to Name","Pay-to Name 2","Pay-to Contact","Pay-to Address","Pay-to Address 2",
          "Pay-to City","Pay-to Post Code","Pay-to County","Pay-to Country/Region Code");
    END;

    PROCEDURE PurchHeaderShipToArch@63(VAR AddrArray@1000 : ARRAY [8] OF Text[50];VAR PurchHeaderArch@1001 : Record 5109);
    BEGIN
      WITH PurchHeaderArch DO
        FormatAddr(
          AddrArray,"Ship-to Name","Ship-to Name 2","Ship-to Contact","Ship-to Address","Ship-to Address 2",
          "Ship-to City","Ship-to Post Code","Ship-to County","Ship-to Country/Region Code");
    END;

    BEGIN
    END.
  }
}

